\documentclass{article}
\usepackage[ae,hyper]{Rd}
\begin{document}
\HeaderA{adjwgt}{Adjust Initial Survey Design Weights}{adjwgt}
\keyword{survey}{adjwgt}
\keyword{misc}{adjwgt}
\begin{Description}\relax
This function adjusts initial survey design weights when implementation results
in use of oversample sites or when it is desired to have final weights sum to a
known frame size.  Adjusted weights are equal to initial weight times the frame
size divided by the sum of the initial weights.  The adjustment is done 
separately for each category specified in argument wtcat.
\end{Description}
\begin{Usage}
\begin{verbatim}
adjwgt(sites, wgt, wtcat, framesize)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sites}] the logical value for each site, where TRUE = include the site
and FALSE = do not include the site.
\item[\code{wgt}] the initial weight (inverse of the sample inclusion probability)
for each site.
\item[\code{wtcat}] the weight adjustment category name for each site.
\item[\code{framesize}] the known size of the frame for each category name in 
wtcat, which must have the names attribute set to match the category 
names used in wtcat.
\end{ldescription}
\end{Arguments}
\begin{Value}
A vector of adjusted weights, where the adjusted weight is set to zero for 
sites that have the logical value in the sites argument set to FALSE.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}
\end{Author}
\begin{Examples}
\begin{ExampleCode}
sites <- as.logical(rep(rep(c("TRUE","FALSE"), c(9,1)), 5))
wgt <- runif(50, 10, 100)
wtcat <- rep(c("A","B"), c(30, 20))
framesize <- c(15, 10)
names(framesize) <- c("A","B")
adjwgt(sites, wgt, wtcat, framesize)
\end{ExampleCode}
\end{Examples}

\HeaderA{albersgeod}{Project Albers Projection in Plane to Spheroid}{albersgeod}
\keyword{survey}{albersgeod}
\begin{Description}\relax
Project Albers projection in plane to spheroid models of the globe.
\end{Description}
\begin{Usage}
\begin{verbatim}
albersgeod(x, y, sph="Clarke1866", clon=-96, clat=23,
  sp1=29.5, sp2=45.5)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{x}] Albers x-coordinate vector to be projected to latitude/longitude.
\item[\code{y}] Albers y-coordinate vector to be projected to latitude/longitude.
\item[\code{sph}] spheroid options: Clarke1866, GRS80, WGS84.  The default is 
Clarke1866.
\item[\code{clon}] center longitude (decimal degrees).  The default is -96.
\item[\code{clat}] origin latitude (decimal degrees).  The default is 23.
\item[\code{sp1}] standard parallel 1 (decimal degrees).  The default is 29.5.
\item[\code{sp2}] standard parallel 2 (decimal degrees).  The default is 45.5.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
Ask Denis White.
\end{Details}
\begin{Value}
A data frame of latitude and longitude projections for x, y Albers coordinates.
\end{Value}
\begin{Author}\relax
Denis White \email{White.Denis@epa.gov}
\end{Author}
\begin{References}\relax
J. Snyder, USGS Professional Paper 1395
\end{References}

\HeaderA{cat.analysis}{Categorical Data Analysis for Probability Survey Data}{cat.analysis}
\keyword{survey}{cat.analysis}
\keyword{univar}{cat.analysis}
\begin{Description}\relax
This function organizes input and output for analysis of categorical data 
generated by a probability survey.  Input can be either an object belonging to
class psurvey.analysis (see the documentation for function psurvey.analysis)
or through use of the other arguments to this function.
\end{Description}
\begin{Usage}
\begin{verbatim}
cat.analysis(sites=NULL, subpop=NULL, design=NULL, data.cat=NULL,
   N.cluster=NULL, popsize=NULL, stage1size=NULL, popcorrect=FALSE,
   sizeweight=FALSE, unitsize=NULL, vartype="Local", conf=95, psurvey.obj=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sites}] a data frame consisting of two variables: the first variable is 
site IDs, and the second variable is a logical vector indicating which
sites to use in the analysis.  If psurvey.obj is not provided, then
this argument is required.  The default is NULL.
\item[\code{subpop}] a data frame describing sets of populations and subpopulations 
for which estimates will be calculated.  The first variable is site  
IDs.  Each subsequent variable identifies a Type of population, where
the variable name is used to identify Type.  A Type variable
identifies each site with one of the subpopulations of that Type.  If
psurvey.obj is not provided, then this argument is required.  The
default is NULL.
\item[\code{design}] a data frame consisting of design variables.  If psurvey.obj is
not provided, then this argument is required.  The default is NULL.
Variables should be named as follows:\\
siteID = site IDs\\
wgt = final adjusted weights, which are either the weights for a
single-stage sample or the stage two weights for a two-stage sample\\
xcoord = x-coordinates for location, which are either the x-coordinates
for a single-stage sample or the stage two x-coordinates for a
two-stage sample\\
ycoord = y-coordinates for location, which are either the y-coordinates
for a single-stage sample or the stage two y-coordinates for a
two-stage sample\\
stratum = the stratum codes\\
cluster = the stage one sampling unit (primary sampling unit or cluster)
codes\\
wgt1 = final adjusted stage one weights\\
xcoord1 = the stage one x-coordinates for location\\
ycoord1 = the stage one y-coordinates for location\\
support = support values - the value one (1) for a site from a 
finite resource or the measure of the sampling unit associated 
with a site from an extensive resource, which is required for 
calculation of finite and continuous population correction 
factors\\
swgt = size-weights, which is the stage two size-weight for a two-
stage sample\\
swgt1 = stage one size-weights
\item[\code{data.cat}] a data frame of categorical response variables.  The first 
variable is site IDs.  Subsequent variables are response variables.
Missing data (NA) is allowed.  If psurvey.obj is not provided, then
this argument is required.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is used to adjust estimators for the known size of a resource.
This argument also is required for calculation of finite and
continuous population correction factors for a single-stage sample.   
The argument must be in the form of a list containing an element for   
each population Type in the subpop data frame, where NULL is a valid   
choice for a population Type.  The list must be named using the column  
names for the population Types in subpop. If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.\\\\
Example popsize for a stratified sample:\\
popsize = list("Pop 1"=c("Stratum 1"=750, "Stratum 2"=500,
"Stratum 3"=250),\\ "Pop2"=list("SubPop 1"=c("Stratum 1"=350,
"Stratum 2"=250, "Stratum 3"=150),\\ "SubPop 2"=c("Stratum 1"=250,
"Stratum 2"=150, "Stratum 3"=100),\\ "SubPop 3"=c("Stratum 1"=150,
"Stratum 2"=150, "Stratum 3"=75)),\\ "Pop 3"=NULL)\\\\
Example popsize for an unstratified sample:\\
popsize = list("Pop 1"=1500, "Pop2"=list("SubPop 1"=750,
"SubPop 2"=500, "SubPop 3"=375), "Pop 3"=NULL)\\
\item[\code{stage1size}] the known size of the stage one sampling units of a 
two-stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \& symbol, e.g.,
"Stratum 1\&Cluster 1".  The default is NULL.
\item[\code{popcorrect}] a logical value that indicates whether finite or continuous 
population correction factors should be employed during variance 
estimation, where TRUE = use the correction factors and FALSE = do not 
use the correction factors.  The default is FALSE.
\item[\code{sizeweight}] a logical value that indicates whether size-weights should 
be used in the analysis, where TRUE = use the size-weights and FALSE = 
do not use the size-weights.  The default is FALSE.
\item[\code{unitsize}] the known sum of the size-weights of the resource.  The 
argument must be in the form of a list containing an element for each  
population Type in the subpop data frame, where NULL is a valid choice  
for a population Type.  The list must be named using the column  
names for population Types in subpop.  If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{psurvey.obj}] a list of class psurvey.analysis that was produced by the
function psurvey.analysis.  Depending on input to that function,
some elements of the list may be NULL.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Value}
Value is a data frame of population estimates for all combinations of subpopulation 
Types, subpopulations within Types, response variables, and categories within 
each response variable.  Estimates are calculated for proportion and size of 
the population.  Standard error estimates and  confidence interval estimates 
also are calculated.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{category.est}{category.est}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
# Categorical variable example for two resource classes
mysiteID <- paste("Site", 1:100, sep="")
mysites <- data.frame(siteID=mysiteID, Active=rep(TRUE, 100))
mysubpop <- data.frame(siteID=mysiteID, All.Sites=rep("All Sites", 100),
   Resource.Class=rep(c("Good","Poor"), c(55,45)))
mydesign <- data.frame(siteID=mysiteID, wgt=runif(100, 10, 100),
   xcoord=runif(100), ycoord=runif(100), stratum=rep(c("Stratum1",
   "Stratum2"), 50))
mydata.cat <- data.frame(siteID=mysiteID, CatVar=rep(c("north", "south",
   "east", "west"), 25))
mypopsize <- list(All.Sites=c(Stratum1=3500, Stratum2=2000),
   Resource.Class=list(Good=c(Stratum1=2500, Stratum2=1500),
   Poor=c(Stratum1=1000, Stratum2=500)))
cat.analysis(sites=mysites, subpop=mysubpop, design=mydesign,
   data.cat=mydata.cat, popsize=mypopsize)

# Exclude category "south" from the analysis
mysites <- data.frame(siteID=mysiteID, Active=rep(c(TRUE, FALSE, TRUE,
   TRUE), 25))
cat.analysis(sites=mysites, subpop=mysubpop, design=mydesign,
   data.cat=mydata.cat, popsize=mypopsize)
\end{ExampleCode}
\end{Examples}

\HeaderA{category.est}{Category Proportion and Size Estimates}{category.est}
\keyword{survey}{category.est}
\keyword{univar}{category.est}
\begin{Description}\relax
This function estimates proportion (expressed as percent) and size of a
resource in each of a set of categories and can also be used to estimate
proportion and size for site status categories.  Upper and lower confidence
bounds also are estimated.
\end{Description}
\begin{Usage}
\begin{verbatim}
category.est(catvar, wgt, x=NULL, y=NULL, stratum=NULL, cluster=NULL,
   N.cluster=NULL, wgt1=NULL, x1=NULL, y1=NULL, popsize=NULL, stage1size=NULL,
   support=NULL, swgt=NULL, swgt1=NULL, unitsize=NULL, vartype="Local", conf=95,
   check.ind=TRUE, warn.ind=NULL, warn.df=NULL, warn.vec=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{catvar}] the value of the categorical response variable or the site
status for each site.
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
\item[\code{x}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{y}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum for each site.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
code for each site.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weight for each site.  The default
is NULL.
\item[\code{x1}] the stage one x-coordinate for location for each site.  The default
is NULL.
\item[\code{y1}] the stage one y-coordinate for location for each site.  The default
is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is required for calculation of finite and continuous population 
correction factors for a single-stage sample.  This variable is also 
used to adjust estimators for the known size of a resource.  For a
stratified sample this variable must be a vector containing a value 
for each stratum and must have the names attribute set to identify the
stratum codes.  The default is NULL.
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \# symbol, e.g.,
"Stratum 1\#Cluster 1".  The default is NULL.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  The default is NULL.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource, which for a 
stratified sample must be a vector containing a value for each stratum 
and must have the names attribute set to identify the stratum codes.  
The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{check.ind}] a logical value that indicates whether compatability
checking of the input values is conducted, where TRUE = conduct 
compatibility checking and FALSE = do not conduct compatibility 
checking.  The default is TRUE.
\item[\code{warn.ind}] a logical value that indicates whether warning messages were
generated, where TRUE = warning messages were generated and FALSE = warning
messages were not generated.  The default is NULL.
\item[\code{warn.df}] a data frame for storing warning messages.  The default is
NULL.
\item[\code{warn.vec}] a vector that contains names of the population type, the
subpopulation, and an indicator.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
Proportion estimates are calculated using the Horvitz-Thompson ratio estimator,
i.e., the ratio of two Horvitz-Thompson estimators.  The numerator of the ratio
estimates the size of the category.  The denominator of the ratio
estimates the size of the resource.   Variance estimates for the proportion
estimates are calculated using either the local mean variance estimator or the
simple random sampling (SRS) variance estimator.  The choice of variance
estimator is subject to user control.  The local mean variance estimator
requires the x-coordinate and the y-coordinate of each site.  The
SRS variance estimator uses the independent  random sample approximation
to calculate joint inclusion probabilities.   Confidence bounds are calculated
using a Normal distribution multiplier.  For a finite resource size is
the number of units in the resource.  For an extensive resource size is the 
measure (extent) of the resource, i.e., length, area, or volume.  Size 
estimates are calculated using the Horvitz- Thompson estimator.  Variance 
estimates for the size estimates are calculated using either the local mean 
variance estimator or the SRS variance estimator. The function can 
accommodate a stratified sample.  For a stratified sample, separate estimates 
and standard errors are calculated for each stratum, which are used to produce 
estimates and standard errors for all strata combined.  Strata that contain a 
single value are removed.  For a stratified sample, when either the size of the
resource or the sum of the size-weights for the resource is provided for each 
stratum, those values are used as  stratum weights for calculating the 
estimates and standard errors for all strata combined.  In addition, when 
either of those known values is provided for each stratum, size estimates are 
obtained by multiplying the proportion estimate, i.e., the Horvitz-Thompson 
ratio estimator, by the known value for the stratum.  For a stratified sample 
when neither the size of the  resource nor the sum of the size-weights of the 
resource is provided for  each stratum, estimated values are used as stratum 
weights for calculating  the estimates and standard errors for all strata 
combined.  The function can accommodate single-stage and two-stage samples for 
both stratified and unstratified sampling designs.  Finite population and 
continuous population correction factors can be utilized in variance 
estimation.  The function checks for compatibility of input values and removes
missing values.
\end{Details}
\begin{Section}{Value}
If the function was called by the cat.analysis function, then value is a list
containing the following components:
\Itemize{
\item \code{Results} - a data frame containing estimates and confidence
bounds
\item \code{warn.ind} - a logical value indicating whether warning messages
were generated
\item \code{warn.df} - a data frame containing warning messages
}
If the function was called directly, then value is a data frame containing
estimates and confidence bounds.
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{Examples}
\begin{ExampleCode}
catvar <- rep(c("north", "south", "east", "west"), rep(25, 4))
wgt <- runif(100, 10, 100)
category.est(catvar, wgt, vartype="SRS")

x <- runif(100)
y <- runif(100)
category.est(catvar, wgt, x, y)
\end{ExampleCode}
\end{Examples}

\HeaderA{cdf.decon}{Cumulative Distribution Function - Deconvolution}{cdf.decon}
\keyword{survey}{cdf.decon}
\keyword{distribution}{cdf.decon}
\begin{Description}\relax
This function calculates an estimate of the deconvoluted cumulative 
distribution function (CDF) for the proportion (expressed as percent) and 
the total of a response variable, where the response variable may be defined
for either a finite or an extensive resource.  Optionally, for a finite 
resource, the size-weighted CDF can be calculated.  In addition the standard 
error of the estimated CDF and confidence bounds are calculated.  The 
simulation extrapolation deconvolution method (Stefanski and Bay, 1996) is
used to deconvolute measurement error variance from the response.
\end{Description}
\begin{Usage}
\begin{verbatim}
cdf.decon(z, wgt, sigma, var.sigma=NULL, x=NULL, y=NULL, stratum=NULL,
   cluster=NULL, N.cluster=NULL, wgt1=NULL, x1=NULL, y1=NULL, popsize=NULL,
   stage1size=NULL, support=NULL, swgt=NULL, swgt1=NULL, unitsize=NULL,
   vartype="Local", conf=95, cdfval=NULL, pctval=c(5,10,25,50,75,90,95),
   check.ind=TRUE, warn.ind=NULL, warn.df=NULL, warn.vec=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{z}] the response value for each site.
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
\item[\code{sigma}] measurement error variance.
\item[\code{var.sigma}] variance of the measurement error variance.  The default is
NULL.
\item[\code{x}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{y}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum for each site.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
code for each site.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weight for each site.  The default
is NULL.
\item[\code{x1}] the stage one x-coordinate for location for each site.  The default
is NULL.
\item[\code{y1}] the stage one y-coordinate for location for each site.  The default
is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is required for calculation of finite and continuous population 
correction factors for a single-stage sample.  This variable is also 
used to adjust estimators for the known size of a resource.  For a
stratified sample this variable must be a vector containing a value 
for each stratum and must have the names attribute set to identify the
stratum codes.  The default is NULL.
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \# symbol, e.g.,
"Stratum 1\#Cluster 1".  The default is NULL.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  The default is NULL.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource, which for a 
stratified sample must be a vector containing a value for each stratum 
and must have the names attribute set to identify the stratum codes.  
The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{cdfval}] the set of values at which the CDF is estimated.  If a set of
values is not provided, then the sorted set of unique values of the
response variable is used.  The default is NULL.
\item[\code{pctval}] the set of values at which percentiles are estimated.  The
default set is: {5, 10, 25, 50, 75, 90, 95}.
\item[\code{check.ind}] a logical value that indicates whether compatability
checking of the input values is conducted, where TRUE = conduct 
compatibility checking and FALSE = do not conduct compatibility 
checking.  The default is TRUE.
\item[\code{warn.ind}] a logical value that indicates whether warning messages were
generated, where TRUE = warning messages were generated and FALSE = warning
messages were not generated.  The default is NULL.
\item[\code{warn.df}] a data frame for storing warning messages.  The default is
NULL.
\item[\code{warn.vec}] a vector that contains names of the population type, the
subpopulation, and an indicator.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
This function calculates an estimate of the deconvoluted cumulative 
distribution function (CDF) for the proportion (expressed as percent) and the 
total of a response  variable, where the response variable may be defined
for either a finite or an extensive resource.  Optionally, for a finite 
resource, the size-weighted CDF can be calculated.  In addition the standard 
error of the estimated CDF and confidence bounds are calculated.  The 
simulation extrapolation deconvolution method (Stefanski and Bay, 1996) is used 
to deconvolute measurement error variance from the response.  The user
can supply the set of values at which the CDF is estimated.  For the 
CDF of a proportion, the Horvitz-Thompson ratio estimator, i.e., the
ratio of two Horvitz-Thompson estimators, is used to calculate the CDF
estimate.  For the CDF of a total, the user can supply the known size of
the resource or the known sum of the size-weights of the resource, as
appropriate.  For the CDF of a total when either the size of the
resource or the sum of the size-weights of the resource is provided, the
classic ratio estimator is used to calculate the CDF estimate, where
that estimator is the product of the known value and the Horvitz-Thompson ratio
estimator.   For the CDF of a total when neither the size of the
resource nor the sum of the size-weights of the resource is provided, the
Horvitz-Thompson estimator is used to calculate the CDF estimate.
Variance estimates for the estimated CDF are calculated using either the
local mean variance estimator or the simple random sampling (SRS) 
variance estimator.  The choice of variance estimator is subject to user 
control. The local mean variance estimator requires the x-coordinate and
the y-coordinate of each site.  The SRS variance estimator uses
the independent random sample approximation to calculate joint inclusion
probabilities.  Confidence bounds are calculated using a Normal
distribution multiplier.  In addition the function uses the estimated 
CDF to calculate percentile estimates.  Estimated confidence bounds for
the percentile estimates are calculated.  The user can supply the set of values
for which percentiles estimates are desired.  Optionally, the user can use the
default set of percentiles.  The function can accommodate a stratified sample.
For a stratified sample, separate estimates and standard errors are calculated
for each stratum, which are used to produce estimates and standard errors for
all strata combined.  Strata that contain a single value are removed.  For a
stratified sample, when either the size of the resource or the sum of the size-
weights of the resource is provided for each stratum, those values are used as 
stratum weights for calculating the estimates and standard  errors for all 
strata combined.  For a stratified sample when neither the size of the resource
nor the sum of the size-weights of the resource is provided for each stratum, 
estimated values are used as stratum weights for calculating the estimates and 
standard errors for all strata combined.   The function can accommodate 
single-stage and two-stage samples for both stratified and unstratified 
sampling designs.  Finite population and continuous population correction 
factors can be utilized in variance estimation.  The function checks for 
compatibility of input values and removes missing values.
\end{Details}
\begin{Section}{Value}
If the function was called by the cont.analysis function, then value is a list
containing the following components:
\Itemize{
\item \code{Results} - a list composed of two objects:
\Itemize{
\item \code{CDF} - a data frame that contains CDF estimates
\item \code{Pct} - a data frame that contains percentile estimates
}
\item \code{warn.ind} - a logical value indicating whether warning messages
were generated
\item \code{warn.df} - a data frame containing warning messages
}
If the function was called directly, then value is a list containing the
following components:
\Itemize{
\item \code{CDF} - a data frame that contains CDF estimates
\item \code{Pct} - a data frame that contains percentile estimates
}
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{Examples}
\begin{ExampleCode}
z <- rnorm(100, 10, 1)
wgt <- runif(100, 10, 100)
cdfval <- seq(min(z), max(z), length=20)
cdf.decon(z, wgt, sigma=0.25, var.sigma=0.1, vartype=
  "SRS", cdfval=cdfval)

x <- runif(100)
y <- runif(100)
cdf.decon(z, wgt, sigma=0.25, var.sigma=0.1, x, y, cdfval=
  cdfval)
\end{ExampleCode}
\end{Examples}

\HeaderA{cdf.est}{Cumulative Distribution Function - Estimation}{cdf.est}
\keyword{survey}{cdf.est}
\keyword{distribution}{cdf.est}
\begin{Description}\relax
This function calculates an estimate of the cumulative distribution function
(CDF) for the proportion (expressed as percent) and the total of a response
variable, where the response variable may be defined for either a finite
or an extensive resource.  Optionally, for a finite resource, the
size-weighted CDF can be calculated.  In addition the standard error of the
estimated CDF and confidence bounds are calculated.
\end{Description}
\begin{Usage}
\begin{verbatim}
cdf.est(z, wgt, x=NULL, y=NULL, stratum=NULL, cluster=NULL, N.cluster=NULL,
   wgt1=NULL, x1=NULL, y1=NULL, popsize=NULL, stage1size=NULL, support=NULL,
   swgt=NULL, swgt1=NULL, unitsize=NULL, vartype="Local", conf=95, cdfval=NULL,
   pctval=c(5,10,25,50,75,90,95), check.ind=TRUE, warn.ind=NULL, warn.df=NULL,
   warn.vec=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{z}] the response value for each site.
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
\item[\code{x}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{y}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum for each site.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
code for each site.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weight for each site.  The default
is NULL.
\item[\code{x1}] the stage one x-coordinate for location for each site.  The default
is NULL.
\item[\code{y1}] the stage one y-coordinate for location for each site.  The default
is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is required for calculation of finite and continuous population 
correction factors for a single-stage sample.  This variable is also 
used to adjust estimators for the known size of a resource.  For a
stratified sample this variable must be a vector containing a value 
for each stratum and must have the names attribute set to identify the
stratum codes.  The default is NULL.
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \# symbol, e.g.,
"Stratum 1\#Cluster 1".  The default is NULL.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  The default is NULL.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource, which for a 
stratified sample must be a vector containing a value for each stratum 
and must have the names attribute set to identify the stratum codes.  
The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{cdfval}] the set of values at which the CDF is estimated.  If a set of
values is not provided, then the sorted set of unique values of the
response variable is used.  The default is NULL.
\item[\code{pctval}] the set of values at which percentiles are estimated.  The
default set is: {5, 10, 25, 50, 75, 90, 95}.
\item[\code{check.ind}] a logical value that indicates whether compatability
checking of the input values is conducted, where TRUE = conduct 
compatibility checking and FALSE = do not conduct compatibility 
checking.  The default is TRUE.
\item[\code{warn.ind}] a logical value that indicates whether warning messages were
generated, where TRUE = warning messages were generated and FALSE = warning
messages were not generated.  The default is NULL.
\item[\code{warn.df}] a data frame for storing warning messages.  The default is
NULL.
\item[\code{warn.vec}] a vector that contains names of the population type, the
subpopulation, and an indicator.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
This function calculates an estimate of the cumulative distribution function
(CDF) for the proportion (expressed as percent) and the total of a
response  variable, where the response variable may be defined for either a
finite or an extensive resource.  Optionally, for a finite resource, the
size-weighted CDF can be calculated.  In addition the standard error of
the estimated CDF and confidence bounds are calculated.  The user
can supply the set of values at which the CDF is estimated.  For the 
CDF of a proportion, the Horvitz-Thompson ratio estimator, i.e., the
ratio of two Horvitz-Thompson estimators, is used to calculate the CDF
estimate.  For the CDF of a total, the user can supply the known size of
the resource or the known sum of the size-weights of the resource, as
appropriate.  For the CDF of a total when either the size of the
resource or the sum of the size-weights of the resource is provided, the
classic ratio estimator is used to calculate the CDF estimate, where
that estimator is the product of the known value and the Horvitz-Thompson ratio
estimator.   For the CDF of a total when neither the size of the
resource nor the sum of the size-weights of the resource is provided, the
Horvitz-Thompson estimator is used to calculate the CDF estimate.
Variance estimates for the estimated CDF are calculated using either the
local mean variance estimator or the simple random sampling (SRS) 
variance estimator.  The choice of variance estimator is subject to user 
control. The local mean variance estimator requires the x-coordinate and
the y-coordinate of each site.  The SRS variance estimator uses
the independent random sample approximation to calculate joint inclusion
probabilities.  Confidence bounds are calculated using a Normal
distribution multiplier.  In addition the function uses the estimated 
CDF to calculate percentile estimates.  Estimated confidence bounds for
the percentile estimates are calculated.  The user can supply the set of values
for which percentiles estimates are desired.  Optionally, the user can use the
default set of percentiles.  The function can accommodate a stratified sample.
For a stratified sample, separate estimates and standard errors are calculated
for each stratum, which are used to produce estimates and standard errors for
all strata combined.  Strata that contain a single value are removed.  For a
stratified sample, when either the size of the resource or the sum of the size-
weights of the resource is provided for each stratum, those values are used as 
stratum weights for calculating the estimates and standard  errors for all 
strata combined.  For a stratified sample when neither the size of the resource
nor the sum of the size-weights of the resource is provided for each stratum, 
estimated values are used as stratum weights for calculating the estimates and 
standard errors for all strata combined.   The function can accommodate 
single-stage and two-stage samples for both stratified and unstratified 
sampling designs.  Finite population and continuous population correction 
factors can be utilized in variance estimation.  The function checks for 
compatibility of input values and removes missing values.
\end{Details}
\begin{Section}{Value}
If the function was called by the cont.analysis function, then value is a list
containing the following components:
\Itemize{
\item \code{Results} - a list composed of two objects:
\Itemize{
\item \code{CDF} - a data frame that contains CDF estimates
\item \code{Pct} - a data frame that contains percentile estimates
}
\item \code{warn.ind} - a logical value indicating whether warning messages
were generated
\item \code{warn.df} - a data frame containing warning messages
}
If the function was called directly, then value is a list containing the
following components:
\Itemize{
\item \code{CDF} - a data frame that contains CDF estimates
\item \code{Pct} - a data frame that contains percentile estimates
}
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{Examples}
\begin{ExampleCode}
z <- rnorm(100, 10, 1)
wgt <- runif(100, 10, 100)
cdfval <- seq(min(z), max(z), length=20)
cdf.est(z, wgt, vartype="SRS", cdfval=cdfval)

x <- runif(100)
y <- runif(100)
cdf.est(z, wgt, x, y, cdfval=cdfval)
\end{ExampleCode}
\end{Examples}

\HeaderA{cdf.test}{Cumulative Distribution Function - Inference}{cdf.test}
\keyword{survey}{cdf.test}
\keyword{distribution}{cdf.test}
\begin{Description}\relax
This function calculates the Wald, Rao-Scott first order corrected (mean 
eigenvalue corrected), and Rao-Scott second order corrected (Satterthwaite
corrected) statistics for categorical data to test for differences between two
cumulative distribution functions (CDFs).  The functions calculates both 
standard versions of those three statistics, which are distributed as 
Chi-squared random variables, plus modified version of the statistics, which 
are distributed as F random variables.
\end{Description}
\begin{Usage}
\begin{verbatim}
cdf.test(sample1, sample2, bounds, vartype="Local")
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sample1}] the sample from the first population in the form of a list
containing the following components:\\
z = the response value for each site\\
wgt = the final adjusted weight (inverse of the sample inclusion probability) for each site\\
x = x-coordinate for location for each site, which may be NULL\\
y = y-coordinate for location for each site, which may be NULL
\item[\code{sample2}] the sample from the second population in the form of a list
containing the following components:\\
z = the response value for each site\\
wgt = the final adjusted weight (inverse of the sample inclusion probability) for each site\\
x = x-coordinate for location for each site, which may be NULL\\
y = y-coordinate for location for each site, which may be NULL
\item[\code{bounds}] upper bounds for calculating the classes for the CDF.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The user supplies the set of upper bounds for defining the classes for the
CDFs.  The Horvitz-Thompson ratio estimator, i.e., the ratio of two
Horvitz-Thompson estimators, is used to calculate estimates of the class
proportions for the CDFs.  Variance estimates for the test statistics are
calculated using either the local mean variance estimator or the simple random
sampling (SRS) variance estimator.  The choice of variance estimator is
subject to user control.  The SRS variance estimator uses the
independent random sample approximation to calculate joint inclusion
probabilities.  The function checks for compatability of input values and
removes missing values.
\end{Details}
\begin{Value}
Value is a data frame containing the test statistic, degrees of 
freedom (two values labeled Degrees of Freedom\_1 and Degrees of  Freedom\_2),
and p value for the Wald, mean eigenvalue, and Satterthwaite test procedures,
which includes both Chi-squared distribution and F  distribution versions of 
the procedures.  For the Chi-squared versions of  the test procedures, Degrees
of Freedom\_1 contains the relevant value  and Degrees of Freedom\_2 is set to 
missing (NA).  For the F-based  versions of the test procedures Degrees of 
Freedom\_1 contains the  numerator degrees of freedom and Degrees of 
Freedom\_2 contains the  denominator degrees of freedom.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Kincaid, T.M. (2000). Testing for differences between cumulative distribution
functions from complex environmental sampling surveys.  In \emph{2000
Proceeding of the Section on Statistics and the Environment}, American
Statistical Association, Alexandria, VA.
\end{References}
\begin{Examples}
\begin{ExampleCode}
resp <- rnorm(100, 10, 1)
wgt <- runif(100, 40, 60)
sample1 <- list(z=resp, wgt=wgt)
sample2 <- list(z=resp+0.5, wgt=wgt)
bounds <- sort(c(sample1$z, sample2$z))[floor(seq(200/3, 200, length=3))]
cdf.test(sample1, sample2, bounds, vartype="SRS")

xcoord <- runif(100)
ycoord <- runif(100)
sample1 <- list(z=resp, wgt=wgt, x=xcoord, y=ycoord)
sample2 <- list(z=1.05*resp, wgt=wgt, x=xcoord, y=ycoord)
cdf.test(sample1, sample2, bounds)
\end{ExampleCode}
\end{Examples}

\HeaderA{cont.analysis}{Continuous Data Analysis for Probability Survey Data}{cont.analysis}
\keyword{survey}{cont.analysis}
\keyword{distribution}{cont.analysis}
\keyword{univar}{cont.analysis}
\begin{Description}\relax
This function organizes input and output for analysis of continuous data 
generated by a probability survey.  Input can be either an object belonging to
class psurvey.analysis (see the documentation for function psurvey.analysis)
or through use of the other arguments to this function.
\end{Description}
\begin{Usage}
\begin{verbatim}
cont.analysis(sites=NULL, subpop=NULL, design=NULL, data.cont=NULL, sigma=NULL,
   var.sigma=NULL, N.cluster=NULL, popsize=NULL, stage1size=NULL,
   popcorrect=FALSE, sizeweight=FALSE, unitsize=NULL, vartype="Local", conf=95,
   pctval=c(5,10,25,50,75,90,95), psurvey.obj=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sites}] a data frame consisting of two variables: the first variable is 
site IDs, and the second variable is a logical vector indicating which
sites to use in the analysis.  If psurvey.obj is not provided, then
this argument is required.  The default is NULL.
\item[\code{subpop}] a data frame describing sets of populations and subpopulations 
for which estimates will be calculated.  The first variable is site  
IDs.  Each subsequent variable identifies a Type of population, where
the variable name is used to identify Type.  A Type variable
identifies each site with one of the subpopulations of that Type.  If
psurvey.obj is not provided, then this argument is required.  The
default is NULL.
\item[\code{design}] a data frame consisting of design variables.  If psurvey.obj is
not provided, then this argument is required.  The default is NULL.
Variables should be named as follows:\\
siteID = site IDs\\
wgt = final adjusted weights, which are either the weights for a
single-stage sample or the stage two weights for a two-stage sample\\
xcoord = x-coordinates for location, which are either the x-coordinates
for a single-stage sample or the stage two x-coordinates for a
two-stage sample\\
ycoord = y-coordinates for location, which are either the y-coordinates
for a single-stage sample or the stage two y-coordinates for a
two-stage sample\\
stratum = the stratum codes\\
cluster = the stage one sampling unit (primary sampling unit or cluster)
codes\\
wgt1 = final adjusted stage one weights\\
xcoord1 = the stage one x-coordinates for location\\
ycoord1 = the stage one y-coordinates for location\\
support = support values - the value one (1) for a site from a 
finite resource or the measure of the sampling unit associated 
with a site from an extensive resource, which is required for 
calculation of finite and continuous population correction 
factors\\
swgt = size-weights, which is the stage two size-weight for a two-
stage sample\\
swgt1 = stage one size-weights
\item[\code{data.cont}] a data frame of continuous response variables.  The first 
variable is site IDs.  Subsequent variables are response variables.
Missing data (NA) is allowed.  If psurvey.obj is not provided, then
this argument is required.  The default is NULL.
\item[\code{sigma}] measurement error variance.  This variable must be a vector
containing a value for each response variable and must have the names
attribute set to identify the response variable names.  Missing data (NA)
is allowed.  The default is NULL.
\item[\code{var.sigma}] variance of the measurement error variance.  This variable
must be a vector containing a value for each response variable and must have
the names attribute set to identify the response variable names.  Missing
data (NA) is allowed.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is used to adjust estimators for the known size of a resource.
This argument also is required for calculation of finite and
continuous population correction factors for a single-stage sample.   
The argument must be in the form of a list containing an element for   
each population Type in the subpop data frame, where NULL is a valid   
choice for a population Type.  The list must be named using the column  
names for the population Types in subpop. If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.\\\\
Example popsize for a stratified sample:\\
popsize = list("Pop 1"=c("Stratum 1"=750, "Stratum 2"=500,
"Stratum 3"=250),\\ "Pop2"=list("SubPop 1"=c("Stratum 1"=350,
"Stratum 2"=250, "Stratum 3"=150),\\ "SubPop 2"=c("Stratum 1"=250,
"Stratum 2"=150, "Stratum 3"=100),\\ "SubPop 3"=c("Stratum 1"=150,
"Stratum 2"=150, "Stratum 3"=75)),\\ "Pop 3"=NULL)\\\\
Example popsize for an unstratified sample:\\
popsize = list("Pop 1"=1500, "Pop2"=list("SubPop 1"=750,
"SubPop 2"=500, "SubPop 3"=375), "Pop 3"=NULL)\\
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \& symbol, e.g.,
"Stratum 1\&Cluster 1".  The default is NULL.
\item[\code{popcorrect}] a logical value that indicates whether finite or continuous 
population correction factors should be employed during variance 
estimation, where TRUE = use the correction factors and FALSE = do not 
use the correction factors.  The default is FALSE.
\item[\code{sizeweight}] a logical value that indicates whether size-weights should 
be used in the analysis, where TRUE = use the size-weights and FALSE = 
do not use the size-weights.  The default is FALSE.
\item[\code{unitsize}] the known sum of the size-weights of the resource.  The 
argument must be in the form of a list containing an element for each  
population Type in the subpop data frame, where NULL is a valid choice  
for a population Type.  The list must be named using the column  
names for population Types in subpop.  If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{pctval}] the set of values at which percentiles are estimated.  The
default set is: {5, 10, 25, 50, 75, 90, 95}.
\item[\code{psurvey.obj}] A list of class psurvey.analysis that was produced by the
function psurvey.analysis.  Depending on input to that function,
some elements of the list may be NULL.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
CDF estimates are calculated for all unique values of a response variable.
\end{Details}
\begin{Section}{Value}
Value is a list containing either two or four data frames of population estimates
for all combinations of population Types, subpopulations within Types, and
response variables.  The data frames containing deconvoluted CDF estimates and
deconvoluted percentile estimates are only included in the output list when an
input value for measurement error variance is provided to the function.  CDF
estimates are calculated for both proportion and size of the population.
Standard error estimates and confidence interval estimates also  are
calculated.  The four data frames are:
\Itemize{
\item \code{CDF} - a data frame containing the CDF estimates
\item \code{Pct} - a data frame containing the percentile estimates plus
population mean, standard deviation, and variance estimates
\item \code{CDF.D} - a data frame containing the deconvoluted CDF estimates
\item \code{Pct.D} - a data frame containing the deconvoluted percentile
estimates
}
\end{Section}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{cdf.est}{cdf.est}, \LinkA{cdf.est}{cdf.est}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
# Continuous variable example
mysiteID <- paste("Site", 1:100, sep="")
mysites <- data.frame(siteID=mysiteID, Active=rep(TRUE, 100))
mysubpop <- data.frame(siteID=mysiteID, All.Sites=rep("All Sites",100),
   Resource.Class=rep(c("Good","Poor"), c(55,45)))
mydesign <- data.frame(siteID=mysiteID, wgt=runif(100, 10, 100),
   xcoord=runif(100), ycoord=runif(100), stratum=rep(c("Stratum1",
   "Stratum2"), 50))
ContVar <- rnorm(100, 10, 1)
mydata.cont <- data.frame(siteID=mysiteID, ContVar=ContVar)
mypopsize <- list(All.Sites=c(Stratum1=3500, Stratum2=2000),
   Resource.Class=list(Good=c(Stratum1=2500, Stratum2=1500),
   Poor=c(Stratum1=1000, Stratum2=500)))
cont.analysis(sites=mysites, subpop=mysubpop, design=mydesign,
   data.cont=mydata.cont, popsize=mypopsize)

# Include deconvolution estimates
mydata.cont <- data.frame(siteID=mysiteID, ContVar=ContVar,
   ContVar.1=ContVar + rnorm(100, 0, sqrt(0.25)),
   ContVar.2=ContVar + rnorm(100, 0, sqrt(0.50)))
mysigma <- c(NA, 0.25, 0.50)
names(mysigma) <- c("ContVar", "ContVar.1", "ContVar.2")
cont.analysis(sites=mysites, subpop=mysubpop[,1:2], design=mydesign,
   data.cont=mydata.cont, sigma=mysigma, popsize=mypopsize[1])
\end{ExampleCode}
\end{Examples}

\HeaderA{dsgnsum}{Summarize the Sites Selected for a Survey Design}{dsgnsum}
\keyword{survey}{dsgnsum}
\begin{Description}\relax
This function summarizes the sites selected for a survey design by producing
contingency tables containing the cross-tabluation of number of sites for
survey design variables and, optionally, for auxiliary variables.
\end{Description}
\begin{Usage}
\begin{verbatim}
dsgnsum(sp.obj, auxvar=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sp.obj}] the sp package object of class "SpatialPointsDataFrame" produced
by the grts function that contains survey design information and additional
attribute (auxiliary) variables.
\item[\code{auxvar}] a vector containing the names of columns from sites that
identify auxiliary variables to be used to summarize the survey design.
\end{ldescription}
\end{Arguments}
\begin{Value}
A list containing the following components:
\begin{ldescription}
\item[\code{DesignSum}] a list of contingency tables containing the cross-tabulation
of number of sites for the following combinations of survey design
variables:\\
(1) multidensity category (mdcaty) and stratum\\
(2) stratum and panel\\
(3) mdcaty, panel, and stratum
\item[\code{AuxVarSum}] a list of contingency tables containing the cross-tabulation
of number of sites for each auxiliary variable and the design variables
mdcaty, panel, and stratum
\end{ldescription}

In addition the output list plus labeling information is printed to the
console.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. Journal of the American Statistical Association \bold{99}:
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grts}{grts}}
\code{\LinkA{framesum}{framesum}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
## Not run: 
test.design <- list(Stratum1=list(panel=c(PanelOne=50),
   seltype="Equal", over=10), Stratum2=list(panel=c(PanelOne=50,
   PanelTwo=50), seltype="Unequal", caty.n=c(CatyOne=25, CatyTwo=25,
   CatyThree=25, CatyFour=25), over=75)
test.attframe <- read.dbf("test.shapefile")
test.sample <- grts(design=test.design, DesignID="Test.Site", type.frame="area",
   src.frame="shapefile", in.shape="test.shapefile", att.frame=test.attframe,
   stratum="test.stratum", mdcaty="test.mdcaty", shapefile=TRUE,
   shapefilename="test.sample")
dsgnsum(test.sample, auxvar=c("test.ecoregion", "test.state"))
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{eco.l3.ut}{Example Polygons Dataset}{eco.l3.ut}
\keyword{datasets}{eco.l3.ut}
\begin{Description}\relax
This dataset is a list composed of two element, each of which is a matrix
containing the x-coordinates and y-coordinates for a polygon.
\end{Description}
\begin{Usage}
\begin{verbatim}data(eco.l3.ut)\end{verbatim}
\end{Usage}
\begin{Format}\relax
A list containing two elements:
\describe{
\item[\code{1}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the first polygon.
\item[\code{2}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the second polygon.
}
\end{Format}
\begin{Source}\relax
This dataset is a subset of the Level III ecoregions in Utah.  Further 
information regarding ecoregions is available at the following web site: 
\url{http://www.epa.gov/wed/pages/ecoregions.htm}
\end{Source}
\begin{References}\relax
Omernik, J.M., (1987). Ecoregions of the conterminous United States. \emph{Annals of 
Association of American Geographers}, \bold{77}, 1-118.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{sp2shape}{sp2shape}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
# This example converts the dataset to an sp package object
data(eco.l3.ut)
n <- length(eco.l3.ut)
nparts <- rep(1, n)
ringdir <- rep(1, n)
IDs <- as.character(1:n)
shapes <- vector(mode="list", length=n)
for(i in 1:n) {
   shapes[[i]] <- list(Pstart=0, verts=eco.l3.ut[[i]], 
      nVerts=nrow(eco.l3.ut[[i]]), nParts=nparts[i])
   attr(shapes[[i]], "RingDir") <- ringdir[i]
}
PolygonsList <- vector(mode="list", length=n)
for(i in 1:n) {
  PolygonsList[[i]] <- shape2spList(shape=shapes[[i]], shp.type="poly",
     ID=IDs[i])
}
att.data <- data.frame(id=1:n, area=1:n)
for(i in 1:n) {
   att.data$area[i] <- PolygonsList[[i]]@area
}
rownames(att.data) <- IDs
sp.obj <- SpatialPolygonsDataFrame(Sr=SpatialPolygons(Srl=PolygonsList),
   data=att.data)
# To convert the sp package object to a shapefile use the following code: 
# sp2shape(sp.obj, "eco.l3.ut")
\end{ExampleCode}
\end{Examples}

\HeaderA{framesum}{Summarize Frame Size for a Survey Design}{framesum}
\keyword{survey}{framesum}
\begin{Description}\relax
This function summarizes the frame for a survey design.  When type.frame
equals "finite", summary is a count of number of units in att.frame for
cross-tabulation of stratum, mdcaty, and auxvar.  When type.frame equals
"linear" or "area", summary is the sum of length or area for units for
cross-tabulation of stratum, mdcaty, and auxvar.  Note that length and area
are taken from length\_mdm and area\_mdm, which are calculated by the function
read.dbf and added to att.frame.  If argument mdcaty or argument stratum
equals NULL or if both arguments equal NULL, then the cross-tabulation is
performed without use of the design variable(s).
\end{Description}
\begin{Usage}
\begin{verbatim}
framesum(att.frame, design, type.frame="finite", stratum=NULL, mdcaty=NULL,
  auxvar=NULL, units.in="Number", scale=1, units.out="Number")
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{att.frame}] a data frame composed of attributes associated with elements
in the frame, which must contain the columns used for stratum and mdcaty (if
required by the survey design).
\item[\code{design}] named list of stratum design specifications which are also
lists.  Stratum names must be subset of values in stratum argument.  Each
stratum list has four list components:\\
panel = named vector of sample sizes for each panel in stratum;\\
seltype = the type of random selection, which must be one of following:
"Equal" - equal probability selection, "Unequal" - unequal probability
selection by the categories specified in caty.n and mdcaty, or
"Continuous" - unequal probability selection proportional to auxiliary
variable mdcaty;\\
caty.n = if seltype equals "Unequal", a named vector of sample sizes for
each category specified by mdcaty, where sum of the sample sizes must
equal sum of the panel sample sizes, and names must be a subset of
values in mdcaty;\\
over = number of replacement sites ("oversample" sites) for the entire
design, which is set equal to 0 if none are required.
\item[\code{type.frame}] the type of frame, which must be one of following: "finite",
"linear", or "area".  The default is "finite"
\item[\code{stratum}] name of the column from att.frame that identifies stratum
membership for each element in the frame.  If stratum equals NULL, the
design is unstratified and a column named stratum with all its elements
equal to "None" is added to att.frame.  The default is NULL.
\item[\code{mdcaty}] name of the column from att.frame that identifies the unequal
probability category for each element in the frame.  The default is
NULL.
\item[\code{auxvar}] a vector containing the names of columns from sites that
identify auxiliary variables to be used to summarize frame size.  The
default is NULL.
\item[\code{units.in}] a character string giving the name of units used to measure
size in the frame.  The default is "Number".
\item[\code{scale}] the scale factor used to change units.in to units.out.  For
example, use 1000 to change "Meters" to "Kilometers".  The default is 1.
\item[\code{units.out}] a character string giving the name of units used to measure
size in the results.  The default is "Number".
\end{ldescription}
\end{Arguments}
\begin{Value}
A list containing the following components:
\begin{ldescription}
\item[\code{DesignSize}] a table (for type.frame equals "finite") or an array (for
type.frame equals "linear" or "area") that contains the cross-tabulation of
frame extent for design variables multidensity category (mdcaty) and
stratum, where extent of the frame is the number of sites for type.frame
equals "finite", the sum of site length for type.frame equals "linear", or
the sum of site area for type.frame equals "area".
\item[\code{AuxVarSize}] a list containing a component for each auxiliary variable,
where each component of the list is one of the following: (1) if the type of
random selection does not equal "Continuous" for any stratum, each component
is either a table (for type.frame equals "finite") or an array (for
type.frame equals "linear" or "area") that contains the cross-tabulation of
frame extent for mdcaty, stratum, and the auxiliary variable or (2) if the
type of random selection equals "Continuous" for all strata, each component
is either a table (finite frame) or an array (linear or area frame)
containing the cross-tabulation of frame extent for stratum and the
auxiliary variable.
\end{ldescription}

In addition the output list plus labeling information is printed to the
console.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. Journal of the American Statistical Association \bold{99}:
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grts}{grts}}
\code{\LinkA{dsgnsum}{dsgnsum}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
## Not run: 
test.attframe <- read.dbf("test.shapefile")
test.design <- list(Stratum1=list(panel=c(PanelOne=50),
   seltype="Equal", over=10), Stratum2=list(panel=c(PanelOne=50,
   PanelTwo=50), seltype="Unequal", caty.n=c(CatyOne=25, CatyTwo=25,
   CatyThree=25, CatyFour=25), over=75)
framesum(att.frame=test.attframe, design=test.design, type.frame="area",
   stratum="test.stratum", mdcaty="test.mdcaty", auxvar=c("test.ecoregion",
   "test.state"), units.in="Meters", scale=1000, units.out="Kilometers")
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{grts}{Generalized Random-Tessellation Stratified (GRTS) Survey Design}{grts}
\keyword{survey}{grts}
\begin{Description}\relax
Selects a sample using a generalized random-tessellation stratified (GRTS)
survey design. The GRTS survey design may include stratification, unequal
probability using categories, unequal selection proportional to an auxiliary
variable, survey over time structures, and provision for an oversample.
\end{Description}
\begin{Usage}
\begin{verbatim}
grts(design, DesignID="Site", SiteBegin=1, type.frame="finite",
   src.frame="shapefile", in.shape=NULL, sp.object=NULL,  att.frame=NULL,
   id=NULL, xcoord=NULL, ycoord=NULL, stratum=NULL, mdcaty=NULL, startlev=NULL,
   maxlev=11, maxtry=1000, shift.grid=TRUE, do.sample=TRUE,shapefile=TRUE,
   prjfilename=NULL, out.shape="sample")
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{design}] named list of stratum design specifications, where each element of
design is a list containing the design specifications for a stratum.  For
an unstratified sample, design contains a single list.  If the sample is
stratified, the names in design must occur among the strata names in the
stratum column of the attributes data frame (att.frame).  If the sample is
unstratified, the name of the single list in design is arbitrary.  Each
list in design has four components:\\
panel = named vector of sample sizes for each panel in stratum\\
seltype = the type of random selection, which must be one of following:
"Equal" - equal probability selection, "Unequal" - unequal probability
selection by the categories specified in caty.n and mdcaty, or
"Continuous" - unequal probability selection proportional to auxiliary
variable mdcaty\\
caty.n = if seltype equals "Unequal", a named vector of sample sizes for
each category specified by mdcaty, where sum of the sample sizes must
equal sum of the panel sample sizes, and names must be a subset of
values in mdcaty\\
over = number of replacement sites ("oversample" sites) for the entire
design, which is set equal to 0 if none are required\\\\
Example design for a stratified sample:\\
design <- list("Stratum 1"=list(panel=c(Panel=50), seltype="Equal",
over=10),\\ "Stratum 2"=list(panel=c("Panel One"=50, "Panel Two"=50),
seltype="Unequal",\\ caty.n=c(CatyOne=25, CatyTwo=25, CatyThree=25,
CatyFour=25), over=75))\\\\
Example design for an unstratified sample:\\
design <- list(None=list(panel=c(Panel1=50, Panel2=100, Panel3=50),
seltype="Unequal",\\ caty.n=c("Caty 1"=50, "Caty 2"=25, "Caty 3"=25,
"Caty 4"=25, "Caty 5"=75), over=100))\\
\item[\code{DesignID}] name for the design, which is used to create a site
ID for each site.  The default is "Site".
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{type.frame}] the type of frame, which must be one of following: "finite",
"linear", or "area".  The default is "finite".
\item[\code{src.frame}] source of the frame, which equals "shapefile" if the frame is
to be read from a shapefile, "sp.object" if the frame is obtained from an sp
package object, or "att.frame" if type.frame equals "finite" and the frame
is included in att.frame.  The default is "shapefile".
\item[\code{in.shape}] name (without any extension) of the input shapefile.  If
src.frame equal "shapefile" and in.shape equals NULL, then the shapefile or
shapefiles in the currrent directory are used.  The default is NULL.
\item[\code{sp.object}] name of the sp package object when src.frame equals
"sp.object".  The default is NULL.
\item[\code{att.frame}] a data frame composed of attributes associated with elements
in the frame, which must contain the columns used for stratum and mdcaty (if 
required).  If src.frame equals "shapefile" and att.frame equals NULL, then
att.frame is created from the dbf file(s) in the current directory.  If
src.frame equals "att.frame", then att.frame includes columns that contain
x-coordinates and y-coordinates for each element in the frame.  The default
is NULL.
\item[\code{id}] name of the column from att.frame that identifies the ID value for
each element in the frame.  If id equals NULL, a column named "id" that
contains values from one through the number of rows in att.frame is added to
att.frame.  The default is NULL.
\item[\code{xcoord}] name of the column from att.frame that identifies x-coordinates
when src.frame equals "att.frame".  If xcoord equals NULL, then xcoord is
given the value "x".  The default is NULL.
\item[\code{ycoord}] name of the column from att.frame that identifies y-coordinates
when src.frame equals "att.frame".  If ycoord equals NULL, then ycoord is
given the value "y".  The default is NULL.
\item[\code{stratum}] name of the column from att.frame that identifies stratum
membership for each element in the frame.  If stratum equals NULL, the
design is unstratified, and a column named "stratum" (with all its elements
equal to the stratum name specified in design) is added to att.frame.  The
default is NULL.
\item[\code{mdcaty}] name of the column from att.frame that identifies the unequal
probability category for each element in the frame.  The default is
NULL.
\item[\code{startlev}] initial number of hierarchical levels to use for the GRTS
grid, which must be less than or equal to maxlev (if maxlev is specified)
and cannot be greater than 11.  The default is NULL.
\item[\code{maxlev}] maximum number of hierarchical levels to use for the GRTS grid,
which cannot be greater than 11.  The default is 11.
\item[\code{maxtry}] maximum number of iterations for randomly generating a point
within a grid cell to select a site when type.frame equals "area".  The
default is 1000.
\item[\code{shift.grid}] option to randomly shift the hierarchical grid, where TRUE
means shift the grid and FALSE means do not shift the grid, which is
useful if one desires strict spatial stratification by hierarchical grid
cells.  The default is TRUE.
\item[\code{do.sample}] option to select a sample, where TRUE means select a sample
and FALSE means return the entire sample frame in reverse hierarchical
order.  Note that FALSE can only be used when type.frame equals "points"
and seltype equals "Equal".  The default is TRUE.
\item[\code{shapefile}] option to create a shapefile containing the survey design
information, where TRUE equals create a shapefile and FALSE equals do not
create a shapefile.  The default is TRUE.
\item[\code{prjfilename}] name (without any extension) of the projection file for the
input shapefile, which is use to name the projection file for the output
shapefile.  The default is NULL.
\item[\code{out.shape}] name (without any extension) of the output shapefile
containing the survey design information.  The default is "sample".
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The GRTS survey design process selects a spatially balanced sample based on
the survey design specification.\\\\
Function dsgnsum(), can be used to summarize the sites selected for a survey
design.
\end{Details}
\begin{Value}
An sp package object containing the survey design information and any
additional attribute variables that were provided.  The object is assigned
class "SpatialPointsDataFrame".  For further information regarding the
output object, see documentation for the sp package.  Optionally, a
shapefile can be created that contains the survey design information.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. \emph{Journal of the American Statistical Association}, \bold{99},
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grtspts}{grtspts}}
\code{\LinkA{grtslin}{grtslin}}
\code{\LinkA{grtsarea}{grtsarea}}
\code{\LinkA{albersgeod}{albersgeod}}
\code{\LinkA{dsgnsum}{dsgnsum}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
## Not run: 
The following example will select a sample from an area resource.  The design
includes two strata.  For Stratum 1, an equal probability sample of size 50
will be selected for a single panel.  For Stratum 2, an unequal probability
sample of size 50 will be selected for each of two panels.  The sample for
Stratum 2 will be approportioned into samples of size 25 for each of four
unequal probability categories.  In addition both strata will include
oversamples (size 10 for Stratum 1 and size 75 for Stratum 2).  It is assumed
that a shapefile defining the polygons for the area resource is located in the
folder from which R is started.  Attribute data for the design will be read
from the dbf file of the shapefile, which is assumed to have variables named
"test.stratum" and "test.mdcaty" that specify stratum membership value and
unequal probability category, respectively, for each record in the shapefile.
A shapefile named "test.sample" containing the survey design information will
be created.
test.design <- list("Stratum 1"=list(panel=c(Panel=50), seltype="Equal",
   over=10), "Stratum 2"=list(panel=c("Panel One"=50, "Panel Two"=50),
   seltype="Unequal", caty.n=c(CatyOne=25, CatyTwo=25, CatyThree=25,
   CatyFour=25), over=75))
test.attframe <- read.dbf("test.shapefile")
test.sample <- grts(design=test.design, DesignID="Test.Site", type.frame="area",
   src.frame="shapefile", in.shape="test.shapefile", att.frame=test.attframe,
   stratum="test.stratum", mdcaty="test.mdcaty", shapefile=TRUE,
   out.shape="test.sample")
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{grtsarea}{Select GRTS Sample of an Area Resource}{grtsarea}
\keyword{survey}{grtsarea}
\begin{Description}\relax
This function select a GRTS sample of an area resource.  This function uses
hierarchical randomization to ensure that the sample will include no more
than one point per cell and then picks a point in selected cells.
\end{Description}
\begin{Usage}
\begin{verbatim}
grtsarea(shapefilename=NULL, areaframe, samplesize=100, SiteBegin=1,
   shift.grid=TRUE, startlev=NULL, maxlev=11, maxtry=1000, acept=1)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{shapefilename}] name of the input shapefile.  If shapefilename equals
NULL, then the shapefile or shapefiles in the currrent directory are used.
The default is NULL.
\item[\code{areaframe}] a data frame containing id, mdcaty and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{shift.grid}] option to randomly shift the hierarchical grid, where TRUE
means shift the grid and FALSE means do not shift the grid, which is
useful if one desires strict spatial stratification by hierarchical grid
cells.  The default is TRUE.
\item[\code{startlev}] initial number of hierarchical levels to use for the GRTS
grid, which must be less than or equal to maxlev (if maxlev is specified)
and cannot be greater than 11.  The default is NULL.
\item[\code{maxlev}] maximum number of hierarchical levels to use for the GRTS grid,
which cannot be greater than 11.  The default is 11.
\item[\code{maxtry}] maximum number of iterations for randomly generating a point
The default is 1000.
\item[\code{acept}] parameter that controls peakedness of a center-peaked
distribution, which must be between 0 and 1.  A value of 0 gives a
triangular distribution, and a value of 1 gives a uniform
distribution.  The default is 1.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of GRTS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. \emph{Journal of the American Statistical Association}, \bold{99},
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grts}{grts}}
\end{SeeAlso}

\HeaderA{grtslin}{Select GRTS Sample of a Linear Resource}{grtslin}
\keyword{survey}{grtslin}
\begin{Description}\relax
This function select a GRTS sample of a linear resource.  This function uses
hierarchical randomization to ensure that the sample will include no more
than one point per cell and then picks a point in selected cells.
\end{Description}
\begin{Usage}
\begin{verbatim}
grtslin(shapefilename=NULL, linframe, samplesize=100, SiteBegin=1,
   shift.grid=TRUE, startlev=NULL, maxlev=11)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{shapefilename}] name of the input shapefile.  If shapefilename equals
NULL, then the shapefile or shapefiles in the currrent directory are used.
The default is NULL.
\item[\code{linframe}] a data frame containing id, mdcaty and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{shift.grid}] option to randomly shift the hierarchical grid, where TRUE
means shift the grid and FALSE means do not shift the grid, which is
useful if one desires strict spatial stratification by hierarchical grid
cells.  The default is TRUE.
\item[\code{startlev}] initial number of hierarchical levels to use for the GRTS
grid, which must be less than or equal to maxlev (if maxlev is specified)
and cannot be greater than 11.  The default is NULL.
\item[\code{maxlev}] maximum number of hierarchical levels to use for the GRTS grid,
which cannot be greater than 11.  The default is 11.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of GRTS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. \emph{Journal of the American Statistical Association}, \bold{99},
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grts}{grts}}
\end{SeeAlso}

\HeaderA{grtspts}{Select GRTS Sample of a Finite Resource}{grtspts}
\keyword{survey}{grtspts}
\begin{Description}\relax
This function select a GRTS sample of a finite resource.  This function uses
hierarchical randomization to ensure that the sample will include no more
than one point per cell and then picks a point in selected cells.
\end{Description}
\begin{Usage}
\begin{verbatim}
grtspts(src.frame="shapefile", shapefilename=NULL, ptsframe, samplesize=100,
   SiteBegin=1, shift.grid=TRUE, do.sample=TRUE, startlev=NULL, maxlev=11) 
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{src.frame}] source of the frame, which equals "shapefile" if the frame is
to be read from a shapefile, or "att.frame" if the frame is included in
ptsframe.  The default is "shapefile".
\item[\code{shapefilename}] name of the input shapefile.  If src.frame equal
"shapefile" and shapefilename equals NULL, then the shapefile or shapefiles
in the currrent directory are used.  The default is NULL.
\item[\code{ptsframe}] a data frame containing id, x, y, mdcaty, and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{shift.grid}] option to randomly shift the hierarchical grid, where TRUE
means shift the grid and FALSE means do not shift the grid, which is
useful if one desires strict spatial stratification by hierarchical grid
cells.  The default is TRUE.
\item[\code{do.sample}] option to select a sample, where TRUE means select a sample 
and FALSE means return the entire sample frame in reverse hierarchical 
order.  The default is TRUE.
\item[\code{startlev}] initial number of hierarchical levels to use for the GRTS
grid, which must be less than or equal to maxlev (if maxlev is specified)
and cannot be greater than 11.  The default is NULL.
\item[\code{maxlev}] maximum number of hierarchical levels to use for the GRTS grid,
which cannot be greater than 11.  The default is 11.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of GRTS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tony Olsen \email{Olsen.Tony@epa.gov}\\
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Stevens, D.L., Jr., and A.R. Olsen. (2004). Spatially-balanced sampling of
natural resources. \emph{Journal of the American Statistical Association}, \bold{99},
262-278.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{grts}{grts}}
\end{SeeAlso}

\HeaderA{irs}{Independent Random Sample (IRS) Survey Design}{irs}
\keyword{survey}{irs}
\begin{Description}\relax
Selects an independent random sample (IRS) survey design. The IRS survey
design may include stratification, unequal probability using categories,
unequal selection proportional to an auxiliary variable, survey over time
structures, and provision for an oversample.
\end{Description}
\begin{Usage}
\begin{verbatim}
irs(design, DesignID="Site", SiteBegin=1, type.frame="finite",
   src.frame="shapefile", in.shape=NULL, sp.object=NULL, att.frame=NULL,
   id=NULL, xcoord=NULL, ycoord=NULL, stratum=NULL, mdcaty=NULL, maxtry=1000,
   shapefile=TRUE, prjfilename=NULL, out.shape="sample")
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{design}] named list of stratum design specifications, where each element of
design is a list containing the design specifications for a stratum.  For
an unstratified sample, design contains a single list.  If the sample is
stratified, the names in design must occur among the strata names in the
stratum column of the attributes data frame (att.frame).  If the sample is
unstratified, the name of the single list in design is arbitrary.  Each
list in design has four components:\\
panel = named vector of sample sizes for each panel in stratum\\
seltype = the type of random selection, which must be one of following:
"Equal" - equal probability selection, "Unequal" - unequal probability
selection by the categories specified in caty.n and mdcaty, or
"Continuous" - unequal probability selection proportional to auxiliary
variable mdcaty\\
caty.n = if seltype equals "Unequal", a named vector of sample sizes for
each category specified by mdcaty, where sum of the sample sizes must
equal sum of the panel sample sizes, and names must be a subset of
values in mdcaty\\
over = number of replacement sites ("oversample" sites) for the entire
design, which is set equal to 0 if none are required\\\\
Example design for a stratified sample:\\
design = list("Stratum 1"=list(panel=c(Panel=50), seltype="Equal",
over=10),\\ "Stratum 2"=list(panel=c("Panel One"=50, "Panel Two"=50),
seltype="Unequal",\\ caty.n=c(CatyOne=25, CatyTwo=25, CatyThree=25,
CatyFour=25), over=75))\\\\
Example design for an unstratified sample:\\
design = list(None=list(panel=c(Panel1=50, Panel2=100, Panel3=50),
seltype="Unequal",\\ caty.n=c("Caty 1"=50, "Caty 2"=25, "Caty 3"=25,
"Caty 4"=25, "Caty 5"=75), over=100))\\
\item[\code{DesignID}] name for the design, which is used to create a site
ID for each site.  The default is "Site".
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{type.frame}] the type of frame, which must be one of following: "finite",
"linear", or "area".  The default is "finite".
\item[\code{src.frame}] source of the frame, which equals "shapefile" if the frame is
to be read from a shapefile, "sp.object" if the frame is obtained from an sp
package object, or "att.frame" if type.frame equals "finite" and the frame
is included in att.frame.  The default is "shapefile".
\item[\code{in.shape}] name (without any extension) of the input shapefile.  If
src.frame equal "shapefile" and in.shape equals NULL, then the shapefile or
shapefiles in the currrent directory are used.  The default is NULL.
\item[\code{sp.object}] name of the sp package object when src.frame equals
"sp.object".  The default is NULL.
\item[\code{att.frame}] a data frame composed of attributes associated with elements
in the frame, which must contain the columns used for stratum and mdcaty (if 
required).  If src.frame equals "shapefile" and att.frame equals NULL, then
att.frame is created from the dbf file(s) in the current directory.  If
src.frame equals "att.frame", then att.frame includes columns that contain
x-coordinates and y-coordinates for each element in the frame.  The default
is NULL.
\item[\code{id}] name of the column from att.frame that identifies the ID value for
each element in the frame.  If id equals NULL, a column named "id" that
contains values from one through the number of rows in att.frame is added to
att.frame.  The default is NULL.
\item[\code{xcoord}] name of the column from att.frame that identifies x-coordinates
when src.frame equals "att.frame".  If xcoord equals NULL, then xcoord is
given the value "x".  The default is NULL.
\item[\code{ycoord}] name of the column from att.frame that identifies y-coordinates
when src.frame equals "att.frame".  If ycoord equals NULL, then ycoord is
given the value "y".  The default is NULL.
\item[\code{stratum}] name of the column from att.frame that identifies stratum
membership for each element in the frame.  If stratum equals NULL, the
design is unstratified, and a column named "stratum" (with all its elements
equal to the stratum name specified in design) is added to att.frame.  The
default is NULL.
\item[\code{mdcaty}] name of the column from att.frame that identifies the unequal
probability category for each element in the frame.  The default is
NULL.
\item[\code{maxtry}] maximum number of iterations for randomly generating a point
within the frame to select a site when type.frame equals "area".  The
default is 1000.
\item[\code{shapefile}] option to create a shapefile containing the survey design
information, where TRUE equals create a shapefile and FALSE equals do not
create a shapefile.  The default is TRUE.
\item[\code{prjfilename}] name (without any extension) of the project file for an
input shapefile.  The default is NULL.
\item[\code{out.shape}] name (without any extension) of the output shapefile
containing the survey design information.  The default is "sample".
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The IRS survey design process selects a sample based on the survey design 
specification.\\\\
Function dsgnsum(), can be used to summarize the sites selected for a survey
design.
\end{Details}
\begin{Value}
An sp package object containing the survey design information and any
additional attribute variables that were provided.  The object is assigned
class "SpatialPointsDataFrame".  For further information regarding the
output object, see documentation for the sp package.  Optionally, a
shapefile can be created that contains the survey design information.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{SeeAlso}\relax
\code{\LinkA{irspts}{irspts}}
\code{\LinkA{irslin}{irslin}}
\code{\LinkA{irsarea}{irsarea}}
\code{\LinkA{dsgnsum}{dsgnsum}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
## Not run: 
# The following example will select a sample from an area resource.  The design
# includes two strata.  For Stratum 1, a sample of size 50 will be selected for
# a single panel.  For Stratum 2, a sample of size 50 will be selected for each
# of two panels.  In addition both strata will include oversamples (size 10 for
# Stratum 1 and size 75 for Stratum 2).  It is assumed that a shapefile defining
# the polygons for the area resource is located in the folder from which R is
# started.  Attribute data for the design will be read from the dbf file of the
# shapefile, which is assumed to have a variable named "test.stratum" that
# specifies stratum membership value for each record in the shapefile. A
# shapefile named "test.sample" containing the survey design information will be
# created.
test.design <- list("Stratum 1"=list(panel=c(Panel=50), seltype="Equal",
   over=10), "Stratum 2"=list(panel=c("Panel One"=50, "Panel Two"=50),
   seltype="Unequal", caty.n=c(CatyOne=25, CatyTwo=25, CatyThree=25,
   CatyFour=25), over=75))
test.attframe <- read.dbf("test.shapefile")
test.sample <- irs(design=test.design, DesignID="Test.Site", type.frame="area",
   src.frame="shapefile", in.shape="test.shapefile", att.frame=test.attframe,
   stratum="test.stratum", mdcaty="test.mdcaty", shapefile=TRUE,
   out.shape="test.sample")
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{irsarea}{Select an Independent Random Sample (IRS) of an Area Resource}{irsarea}
\keyword{survey}{irsarea}
\begin{Description}\relax
This function selects an independent random sample (IRS) of an area resource.
\end{Description}
\begin{Usage}
\begin{verbatim}
irsarea(shapefilename=NULL, areaframe, samplesize=100, SiteBegin=1, maxtry=1000)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{shapefilename}] name of the input shapefile.  If shapefilename equals
NULL, then the shapefile or shapefiles in the currrent directory are used.
The default is NULL.
\item[\code{areaframe}] a data frame containing id, mdcaty and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\item[\code{maxtry}] maximum number of iterations for randomly generating a point
within the frame to select a site when type.frame equals "area".  The
default is 1000.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of IRS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{SeeAlso}\relax
\code{\LinkA{irs}{irs}}
\end{SeeAlso}

\HeaderA{irslin}{Select an Independent Random Sample (IRS) of a Linear Resource}{irslin}
\keyword{survey}{irslin}
\begin{Description}\relax
This function selects an independent random sample (IRS) of a linear resource.
\end{Description}
\begin{Usage}
\begin{verbatim}
irslin(shapefilename=NULL, linframe, samplesize=100, SiteBegin=1)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{shapefilename}] name of the input shapefile.  If shapefilename equals
NULL, then the shapefile or shapefiles in the currrent directory are used.
The default is NULL.
\item[\code{linframe}] a data frame containing id, mdcaty and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of IRS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{SeeAlso}\relax
\code{\LinkA{irs}{irs}}
\end{SeeAlso}

\HeaderA{irspts}{Select an Independent Random Sample (IRS) of a Finite Resource}{irspts}
\keyword{survey}{irspts}
\begin{Description}\relax
This function selects an independent random sample (IRS) of a finite resource.
\end{Description}
\begin{Usage}
\begin{verbatim}
irspts(ptsframe, samplesize=100, SiteBegin=1)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{ptsframe}] a data frame containing id, x, y, mdcaty, and mdm.
\item[\code{samplesize}] number of points to select in the sample.  The default is
100.
\item[\code{SiteBegin}] number to use for first site in the design.  The default is
1.
\end{ldescription}
\end{Arguments}
\begin{Value}
A data frame of IRS sample points containing: SiteID, id, x, y, mdcaty,
and weight.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{SeeAlso}\relax
\code{\LinkA{irs}{irs}}
\end{SeeAlso}

\HeaderA{luck.ash}{Example Polygons Dataset}{luck.ash}
\keyword{datasets}{luck.ash}
\begin{Description}\relax
This dataset is a list composed of two element, each of which is a matrix
containing the x-coordinates and y-coordinates for a polyline.
\end{Description}
\begin{Usage}
\begin{verbatim}data(luck.ash)\end{verbatim}
\end{Usage}
\begin{Format}\relax
A list containing two elements:
\describe{
\item[\code{1}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the first polyline.
\item[\code{2}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the second polyline.
\item[\code{3}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the third polyline.
\item[\code{4}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the fourth polyline.
\item[\code{5}] a matrix containing two variables named xcoord and ycoord,
which are the x-coordinates and y-coordinates for the fifth polyline.
}
\end{Format}
\begin{Source}\relax
This dataset is a subset of all perennial and intermittent streams and rivers in 
the Luckiamute Watershed Council basin in Oregon.  Watershed boundaries were 
defined by the Luckiamute Watershed Council.  The GIS stream network coverage 
was obtained from the Pacific Northwest (PNW) portion of  the U.S. EPA reach 
file system (RF3).
\end{Source}
\begin{References}\relax
Horn, C.R. and Grayman, W.M. (1993). Water-quality modeling with EPA reach file 
system.  \emph{Journal of Water Resources Planning and Management}, \bold{119}, 262-274.
\end{References}
\begin{Examples}
\begin{ExampleCode}
# This example converts the dataset to an sp package object
data(luck.ash)
n <- length(luck.ash)
nparts <- rep(1, n)
IDs <- as.character(1:n)
shapes <- vector(mode="list", length=n)
for(i in 1:n) {
   shapes[[i]] <- list(Pstart=0, verts=luck.ash[[i]], 
      nVerts=nrow(luck.ash[[i]]), nParts=nparts[i])
}
PolylinesList <- vector(mode="list", length=n)
for(i in 1:n) {
  PolylinesList[[i]] <- shape2spList(shape=shapes[[i]], shp.type="arc",
     ID=IDs[i])
}
att.data <- data.frame(id=1:n, length=rep(NA, n))
rownames(att.data) <- IDs
sp.obj <- SpatialLinesDataFrame(sl=SpatialLines(LinesList=PolylinesList),
   data=att.data)
# To convert the sp package object to a shapefile use the following code: 
# sp2shape(sp.obj, "luck.ash")
\end{ExampleCode}
\end{Examples}

\HeaderA{marinus}{Convert Coordinates from Latitude/Longitude to the Equidistant, Cylindric Map Projection}{marinus}
\keyword{misc}{marinus}
\begin{Description}\relax
This function converts x,y coordinates measured in units of latitude and 
longitude, i.e., geographic coordinates measured in decimal degrees, to 
coordinates in the equidistant, cylindric map projection measured in units of
kilometers.  The projection center is defined as the midpoint in latitude-
longitude space.  The map projection is here named after Marinus of Tyre.
\end{Description}
\begin{Usage}
\begin{verbatim}
marinus(lat, lon)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{lat}] vector of latitudes.
\item[\code{lon}] vector of longitudes.
\end{ldescription}
\end{Arguments}
\begin{Value}
A matrix with column names "x" and "y" containing the x and y coordinates 
in the equidistant, cylindric map projection measured in units of kilometers.
\end{Value}
\begin{Author}\relax
Denis White \email{White.Denis@epa.gov}
\end{Author}
\begin{References}\relax
J.P. Snyder. USGS Prof. Paper 1395, p. 90.
\end{References}
\begin{Examples}
\begin{ExampleCode}
lat <- 45 + runif(100, -5, 5)
lon <- 120 + runif(100, -10, 10)
marinus(lat, lon)
\end{ExampleCode}
\end{Examples}

\HeaderA{psurvey.analysis}{Create an Object of Class psurvey.analysis}{psurvey.analysis}
\keyword{survey}{psurvey.analysis}
\begin{Description}\relax
This function creates an object of class psurvey.analysis that contains all 
of the information necessary to use the analysis functions in the 
psurvey.analysis library.
\end{Description}
\begin{Usage}
\begin{verbatim}
psurvey.analysis(sites=NULL, subpop=NULL, design=NULL, data.cat=NULL,
   data.cont=NULL, siteID=NULL, wgt=NULL, sigma=NULL, var.sigma=NULL,
   xcoord=NULL, ycoord=NULL, stratum=NULL, cluster=NULL, N.cluster=NULL,
   wgt1=NULL, xcoord1=NULL, ycoord1=NULL, popsize=NULL, stage1size=NULL,
   popcorrect=FALSE, support=NULL, sizeweight=FALSE, swgt=NULL, swgt1=NULL,
   unitsize=NULL, vartype="Local", conf=95, pctval=c(5,10,25,50,75,90,95))
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sites}] a data frame consisting of two variables: the first variable is 
site IDs and the second variable is a logical vector indicating which 
sites to use in the analysis.  If this data frame is not provided,  
then the data frame will be created, where (1) site IDs are obtained  
either from the design argument, the siteID argument, or both (when  
siteID is a formula); and (2) a variable named use.sites that contains the 
value TRUE for all sites is created.  
The default is NULL.
\item[\code{subpop}] a data frame describing sets of populations and subpopulations 
for which estimates will be calculated.  The first variable is site  
IDs and each subsequent variable identifies a Type of population,  
where the variable name is used to identify Type.  A Type variable  
identifies each site with one of the subpopulations of that Type.  If   
this data frame is not provided, then the data frame will be created,  
where (1) site IDs are obtained either from the design argument, the  
siteID argument, or both (when siteID is a formula); and (2) a single Type 
variable named all.sites that contains the value "All Sites" for all sites 
is created.  The default is NULL.
\item[\code{design}] a data frame consisting of design variables.  If variable names 
are provided as formulas in the corresponding arguments, then the 
formulas are interpreted using this data frame.  If this data frame is 
not provided, then the data frame will be created from inputs to the 
design variables in the argument list.  The default is NULL.  If 
variable names are not provided as formulas, then variables should be 
named as follows:\\
siteID = site IDs\\
wgt = final adjusted weights\\
xcoord = x-coordinates for location\\
ycoord = y-coordinates for location\\
stratum = stratum codes\\
cluster = stage one sampling unit codes\\
wgt1 = final adjusted stage one weights\\
xcoord1 = stage one x-coordinates for location\\
ycoord1 = stage one y-coordinates for location\\
support = support values\\
swgt = size-weights\\
swgt1 = stage one size-weights
\item[\code{data.cat}] a data frame of categorical response variables.  The first 
variable is site IDs.  Subsequent variables are response variables.
Missing data (NA) is allowed.  The default is NULL.
\item[\code{data.cont}] a data frame of continuous response variables.  The first 
variable is site IDs.  Subsequent variables are response variables.
Missing data (NA) is allowed.  The default is NULL.
\item[\code{siteID}] site IDs.  This variable can be input directly or as a formula 
and must be supplied either as this argument or in the design data 
frame.  The default is NULL.
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
The default is NULL.
\item[\code{sigma}] measurement error variance.  This variable must be a vector
containing a value for each response variable and must have the names
attribute set to identify the response variable names.  Missing data (NA)
is allowed.  The default is NULL.
\item[\code{var.sigma}] variance of the measurement error variance.  This variable
must be a vector containing a value for each response variable and must have
the names attribute set to identify the response variable names.  Missing
data (NA) is allowed.  The default is NULL.
\item[\code{xcoord}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{ycoord}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum codes.  This variable can be input directly or as a 
formula.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
codes.  This variable can be input directly or as a formula.  The 
default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weights.  This variable can be input 
directly or as a formula.  The default is NULL.
\item[\code{xcoord1}] the stage one x-coordinates for location.  This variable can be 
input directly or as a formula.  The default is NULL.
\item[\code{ycoord1}] the stage one y-coordinates for location.  This variable can be 
input directly or as a formula.  The default is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is used to adjust estimators for the known size of a resource.
This argument also is required for calculation of finite and
continuous population correction factors for a single-stage sample.   
The argument must be in the form of a list containing an element for   
each population Type in the subpop data frame, where NULL is a valid   
choice for a population Type.  The list must be named using the column  
names for the population Types in subpop. If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.\\\\
Example popsize for a stratified sample:\\
popsize = list("Pop 1"=c("Stratum 1"=750, "Stratum 2"=500,
"Stratum 3"=250),\\ "Pop2"=list("SubPop 1"=c("Stratum 1"=350,
"Stratum 2"=250, "Stratum 3"=150),\\ "SubPop 2"=c("Stratum 1"=250,
"Stratum 2"=150, "Stratum 3"=100),\\ "SubPop 3"=c("Stratum 1"=150,
"Stratum 2"=150, "Stratum 3"=75)),\\ "Pop 3"=NULL)\\\\
Example popsize for an unstratified sample:\\
popsize = list("Pop 1"=1500, "Pop2"=list("SubPop 1"=750,
"SubPop 2"=500, "SubPop 3"=375), "Pop 3"=NULL)\\
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \& symbol, e.g.,
"Stratum 1\&Cluster 1".  The default is NULL.
\item[\code{popcorrect}] a logical value that indicates whether finite or continuous 
population correction factors should be employed during variance 
estimation, where TRUE = use the correction factors and FALSE = do not 
use the correction factors.  The default is FALSE.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  This variable can be input directly or as a formula.  The default
is NULL.
\item[\code{sizeweight}] a logical value that indicates whether size-weights should 
be used in the analysis, where TRUE = use the size-weights and FALSE = 
do not use the size-weights.  The default is FALSE.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  This variable can be input directly or as a 
formula.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  This variable can be 
input directly or as a formula.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource.  The 
argument must be in the form of a list containing an element for each  
population Type in the subpop data frame, where NULL is a valid choice  
for a population Type.  The list must be named using the column  
names for population Types in subpop.  If a population Type doesn't  
contain subpopulations, then each element of the list is either a  
single value for an unstratified sample or a vector containing a value  
for each stratum for a stratified sample, where elements of the vector
are named using the stratum codes.  If a population Type contains 
subpopulations, then each element of the list is a list containing an 
element for each subpopulation, where the list is named using the 
subpopulation names.  The element for each subpopulation will be 
either a single value for an unstratified sample or a named vector of 
values for a stratified sample.  The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{pctval}] the set of values at which percentiles are estimated.  The 
default set is: {5, 10, 25, 50, 75, 90, 95}.
\end{ldescription}
\end{Arguments}
\begin{Section}{Value}
Value is a list of class psurvey.analysis.  Only those sites indicated by the 
logical variable in the sites data frame are retained in the output. The
sites, subpop, and design data frames will always exist in the output. At 
least one of the data.cat and data.cont data frames will exist.  Depending
upon values of the input variables, other elements in the output may be 
NULL.  The list is composed of the following components:
\Itemize{
\item \code{sites} - the sites data frame
\item \code{subpop} - the subpop data frame
\item \code{design} - the design data frame
\item \code{data.cat} - the data.cat data frame
\item \code{data.cont} - the data.cont data frame
\item \code{N.cluster} - the number of stage one sampling units in the
resource
\item \code{popsize} - the known size of the resource
\item \code{stage1size} - the known size of the stage one sampling units
\item \code{unitsize} - the known sum of the size-weights of the resource
\item \code{stratum.ind} - a logical value that indicates whether the sample
is stratified, where TRUE = a stratified sample and FALSE = not a
stratified sample
\item \code{cluster.ind} - a logical value that indicates whether the sample
is a two-stage sample, where TRUE = a two-stage sample and FALSE = not a
two-stage sample
\item \code{pcfactor.ind} - a logical value that indicates whether the
population correction factor is used during variance estimation, where
TRUE = use the population correction factor and FALSE = do not use the
factor
\item \code{swgt.ind} - a logical value that indicates whether the sample is
a size-weighted sample, where TRUE = a size-weighted sample and FALSE =
not a  size-weighted sample
\item \code{vartype} - the choice of variance estimator, where "Local" =
local mean estimator and "SRS" = SRS estimator
\item \code{conf} - the confidence level
\item \code{pctval} - the set of values at which percentiles are estimated,
where the default set is: {5, 25, 50, 75, 95}
}
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{cat.analysis}{cat.analysis}, \LinkA{cat.analysis}{cat.analysis}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
# Categorical variable example
mysiteID <- paste("Site", 1:100, sep="")
mysites <- data.frame(siteID=mysiteID, Active=rep(TRUE, 100))
mysubpop <- data.frame(siteID=mysiteID, All.Sites=rep("All Sites", 100),
   Resource.Class=rep(c("Good","Poor"), c(55,45)))
mydesign <- data.frame(siteID=mysiteID, wgt=runif(100, 10,
   100), xcoord=runif(100), ycoord=runif(100), stratum= rep(c("Stratum1",
   "Stratum2"), 50))
mydata.cat <- data.frame(siteID=mysiteID, CatVar= rep(c("north", "south",
   "east", "west"), 25))
mypopsize <- list(All.Sites=c(Stratum1=3500, Stratum2=2000),
   Resource.Class=list(Good=c(Stratum1=2500, Stratum2=1500),
   Poor=c(Stratum1=1000, Stratum2=500)))
psurvey.analysis(sites=mysites, subpop=mysubpop, design=mydesign,
   data.cat=mydata.cat, popsize=mypopsize)

# Continuous variable example - including deconvolution estimates
mydesign <- data.frame(ID=mysiteID, wgt=runif(100, 10, 100),
   xcoord=runif(100), ycoord=runif(100), stratum=rep(c("Stratum1",
   "Stratum2"), 50))
ContVar <- rnorm(100, 10, 1)
mydata.cont <- data.frame(siteID=mysiteID, ContVar=ContVar,
   ContVar.1=ContVar + rnorm(100, 0, sqrt(0.25)),
   ContVar.2=ContVar + rnorm(100, 0, sqrt(0.50)))
mysigma <- c(ContVar=NA, ContVar.1=0.25, ContVar.2=0.50)
psurvey.analysis(sites=mysites, subpop=mysubpop, design=mydesign,
   data.cont=mydata.cont, siteID=~ID, sigma=mysigma,
   popsize=mypopsize)
\end{ExampleCode}
\end{Examples}

\HeaderA{read.dbf}{Read the Attribute (dbf) File of an ESRI Shapefile}{read.dbf}
\keyword{survey}{read.dbf}
\begin{Description}\relax
This function reads either a single dbf file or multiple dbf files.  For 
multiple dbf files, all of the dbf files must have the same variable names.
\end{Description}
\begin{Usage}
\begin{verbatim}
read.dbf(filename=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] name of the dbf file without any extension.  If filename 
equals a dbf file name, then that dbf file is read.  If filename 
equals NULL, then all of the dbf files in the current directory are 
read.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
Function summary(), i.e., summary.SurveyFrame(), can be used to summarize the 
the frame for a survey design.
\end{Details}
\begin{Value}
A data frame composed of either the contents of the single dbf file, when
filename is provided, or the contents of the dbf file(s) in the current
directory, when filename is NULL.  The data frame is assigned class
"SurveyFrame".
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
ESRI Shapefile Technical Description: 
\url{http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf}
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{read.shape}{read.shape}}
\code{\LinkA{framesum}{framesum}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
  ## Not run: 
  read.shape("my.dbffile")
  
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{read.shape}{Read an ESRI Shapefile}{read.shape}
\keyword{IO}{read.shape}
\begin{Description}\relax
This function reads either a single shapefile or multiple shapefiles.  For 
multiple shapefiles, all of the shapefiles must be the same type, i.e., 
point, polyline, or polygon.
\end{Description}
\begin{Usage}
\begin{verbatim}
read.shape(filename=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{filename}] name of the shapefile without any extension.  If filename 
equals a shapefile name, than that shapefile is read.  If filename 
equals NULL, then all of the shapefiles in the current directory are 
read.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Value}
An sp package object containing information in the shapefile.  The object is
assigned class "SpatialPointsDataFrame", "SpatialLinesDataFrame", or
"SpatialPolygonsDataFrame" corresponding to the shapefile type, i.e., point,
polyline, or polygon, respectively.  For further information regarding the
output object, see documentation for the sp package.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
ESRI Shapefile Technical Description: 
\url{http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf}
\end{References}
\begin{SeeAlso}\relax
\code{\LinkA{read.dbf}{read.dbf}}
\end{SeeAlso}
\begin{Examples}
\begin{ExampleCode}
  ## Not run: 
  read.shape("my.shapefile")
  
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{relrisk}{Relative Risk}{relrisk}
\keyword{survey}{relrisk}
\keyword{survival}{relrisk}
\begin{Description}\relax
This function calculates the relative risk estimate for a 2x2 table of cell
counts defined by a categorical response variable and a categorical
explanatory (stressor) variable for an unequal probability design.  Relative
risk is the ratio of two probabilities: the numerator is the probability that
the first level of the response variable is observed given occurrence of the
first level of the stressor variable, and the denominator is the probability
that the first level of the response variable is observed given occurrence of
the second level of the stressor variable.  The standard error of the base e
log of the relative risk estimate and confidence limits for the estimate also
are calculated.
\end{Description}
\begin{Usage}
\begin{verbatim}
relrisk(dframe, response="response", stressor="stressor",
   response.levels=c("Poor", "Good"), stressor.levels=c("Poor", "Good"),
   wgt="wgt", xcoord="xcoord", ycoord="ycoord", stratum=NULL, cluster=NULL,
   N.cluster=NULL, wgt1=NULL, xcoord1=NULL, ycoord1=NULL, popsize=NULL,
   stage1size=NULL, support=NULL, swgt=NULL, swgt1=NULL, unitsize=NULL,
   vartype="Local", conf=95, check.ind=TRUE)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{dframe}] a data frame containing the variables required for the analysis.
If variable names are not provided in the corresponding arguments,
then variables should be named as follows:\\
response = the categorical response variable values\\
stressor = the categorical explanatory (stressor) variable values\\
wgt = the final adjusted weights\\
xcoord = the x-coordinates for location\\
ycoord = the y-coordinates for location\\
stratum = the stratum codes
\item[\code{response}] name of the column in dframe containing the categorical
response variable.  The default is "response".
\item[\code{stressor}] name of the column in dframe containing the categorical
stressor variable.  The default is "stressor".
\item[\code{response.levels}] category values (levels) for the categorical response
variable, where the first level is used for calculating the relative risk 
estimate.  If response.levels is not supplied, then values "Poor" and "Good"
are used for the first level and second level of the response variable,
respectively.  The default is c("Poor", "Good").
\item[\code{stressor.levels}] category values (levels) for the categorical stressor
variable, where the first level is used for calculating the numerator of 
the relative risk estimate and the second level is used for calculating 
the denominator of the estimate.  If stressor.levels is not supplied, then
values "Poor" and "Good" are used for the first level and second level of
the stressor variable, respectively.  The default is c("Poor", "Good").
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
\item[\code{xcoord}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{ycoord}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum for each site.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
code for each site.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weight for each site.  The default
is NULL.
\item[\code{xcoord1}] the stage one x-coordinate for location for each site.  The
default is NULL.
\item[\code{ycoord1}] the stage one y-coordinate for location for each site.  The
default is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is required for calculation of finite and continuous population 
correction factors for a single-stage sample.  This variable is also 
used to adjust estimators for the known size of a resource.  For a
stratified sample this variable must be a vector containing a value 
for each stratum and must have the names attribute set to identify the
stratum codes.  The default is NULL.
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \# symbol, e.g.,
"Stratum 1\#Cluster 1".  The default is NULL.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  The default is NULL.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource, which for a 
stratified sample must be a vector containing a value for each stratum 
and must have the names attribute set to identify the stratum codes.  
The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{check.ind}] a logical value that indicates whether compatability
checking of the input values is conducted, where TRUE = conduct 
compatibility checking and FALSE = do not conduct compatibility 
checking.  The default is TRUE.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The relative risk estimate is computed using the ratio of a numerator
probability to a denominator probability, which are estimated using cell and
marginal totals from a 2x2 table of cell counts defined by a categorical
response variable and a categorical stressor variable. An estimate of the
numerator probability is provided by the ratio of the cell total defined by
the first level of response variable and the first level of the stressor
variable to the marginal total for the first level of the stressor variable.
An estimate of the denominator probability is provided by the ratio of the
cell total defined by the first level of response variable and the second
level of the stressor variable to the marginal total for the second level of
the stressor variable.  Cell and marginal totals are estimated using the
Horvitz-Thompson estimator. The standard error of the base e log of the
relative risk estimate is calculated using a first-order Taylor series
linearization (Sarndal et al., 1992).
\end{Details}
\begin{Section}{Value}
Value is a list containing the following components:
\Itemize{
\item \code{RelRisk} - the relative risk estimate
\item \code{RRnum} - numerator ("elevated" risk) of the relative risk
estimate
\item \code{RRdenom} - denominator ("baseline" risk) of the relative risk
estimate
\item \code{RRlog.se} - standard error for the log of the relative risk
estimate
\item \code{ConfLimits} - confidence limits for the relative risk estimate
\item \code{WeightTotal} - sum of the final adjusted weights
\item \code{CellCounts} - cell and margin counts for the 2x2 table
\item \code{CellProportions} - estimated cell proportions for the 2x2 table
}
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Srndal, C.-E., B. Swensson, and J. Wretman. (1992). \emph{Model Assisted
Survey Sampling.} Springer-Verlag, New York.
\end{References}
\begin{Examples}
\begin{ExampleCode}
dframe <- data.frame(response=sample(c("Poor", "Good"), 100, replace=TRUE),
   stressor=sample(c("Poor", "Good"), 100, replace=TRUE),
   wgt=runif(100, 10, 100))
relrisk(dframe, vartype="SRS")

dframe$xcoord <- runif(100)
dframe$ycoord <- runif(100)
relrisk(dframe)
\end{ExampleCode}
\end{Examples}

\HeaderA{sp2shape}{Convert an sp Package Object to an ESRI Shapefile}{sp2shape}
\keyword{IO}{sp2shape}
\begin{Description}\relax
This function creates an ESRI shapefile from an sp package object.  The type 
of shapefile, i.e., point, polyline, or polygon, is determined by the class of
the sp object, which must be either "SpatialPointsDataFrame",
"SpatialLinesDataFrame", or "SpatialPolygonsDataFrame".
\end{Description}
\begin{Usage}
\begin{verbatim}
sp2shape(sp.obj, shpfilename="tempfile", prjfilename=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{sp.obj}] the sp package object.
\item[\code{shpfilename}] name (without any extension) of the output shapefile.  The
default is "tempfile".
\item[\code{prjfilename}] name (without any extension) of the projection file for the
output shapefile.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Value}
An ESRI shapefile of type point, polyline, or polygon.
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
ESRI Shapefile Technical Description: 
\url{http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf}
\end{References}
\begin{Examples}
\begin{ExampleCode}
  ## Not run: 
  sp2shape(my.sp.object, "my.shapefile")
  
## End(Not run)
\end{ExampleCode}
\end{Examples}

\HeaderA{spsurvey-internal}{Internal spsurvey Functions}{spsurvey.Rdash.internal}
\aliasA{catvar.prop}{spsurvey-internal}{catvar.prop}
\aliasA{catvar.size}{spsurvey-internal}{catvar.size}
\aliasA{cdf.nresp}{spsurvey-internal}{cdf.nresp}
\aliasA{cdf.prop}{spsurvey-internal}{cdf.prop}
\aliasA{cdf.size.prop}{spsurvey-internal}{cdf.size.prop}
\aliasA{cdf.size.total}{spsurvey-internal}{cdf.size.total}
\aliasA{cdf.total}{spsurvey-internal}{cdf.total}
\aliasA{cdfvar.prop}{spsurvey-internal}{cdfvar.prop}
\aliasA{cdfvar.size.prop}{spsurvey-internal}{cdfvar.size.prop}
\aliasA{cdfvar.size.total}{spsurvey-internal}{cdfvar.size.total}
\aliasA{cdfvar.test}{spsurvey-internal}{cdfvar.test}
\aliasA{cdfvar.total}{spsurvey-internal}{cdfvar.total}
\aliasA{cell.wt}{spsurvey-internal}{cell.wt}
\aliasA{constructAddr}{spsurvey-internal}{constructAddr}
\aliasA{dcdf.prop}{spsurvey-internal}{dcdf.prop}
\aliasA{dcdf.size.prop}{spsurvey-internal}{dcdf.size.prop}
\aliasA{dcdf.size.total}{spsurvey-internal}{dcdf.size.total}
\aliasA{dcdf.total}{spsurvey-internal}{dcdf.total}
\aliasA{dcdfvar.prop}{spsurvey-internal}{dcdfvar.prop}
\aliasA{dcdfvar.size.prop}{spsurvey-internal}{dcdfvar.size.prop}
\aliasA{dcdfvar.size.total}{spsurvey-internal}{dcdfvar.size.total}
\aliasA{dcdfvar.total}{spsurvey-internal}{dcdfvar.total}
\aliasA{dframe.check}{spsurvey-internal}{dframe.check}
\aliasA{ftnt.inv.fcn}{spsurvey-internal}{ftnt.inv.fcn}
\aliasA{getRecordIDs}{spsurvey-internal}{getRecordIDs}
\aliasA{getRecordShapeSizes}{spsurvey-internal}{getRecordShapeSizes}
\aliasA{getShapeBox}{spsurvey-internal}{getShapeBox}
\aliasA{input.check}{spsurvey-internal}{input.check}
\aliasA{input.format}{spsurvey-internal}{input.format}
\aliasA{isotonic}{spsurvey-internal}{isotonic}
\aliasA{linSample}{spsurvey-internal}{linSample}
\aliasA{linSampleIRS}{spsurvey-internal}{linSampleIRS}
\aliasA{localmean.cov}{spsurvey-internal}{localmean.cov}
\aliasA{localmean.df}{spsurvey-internal}{localmean.df}
\aliasA{localmean.var}{spsurvey-internal}{localmean.var}
\aliasA{localmean.weight}{spsurvey-internal}{localmean.weight}
\aliasA{mdmarea}{spsurvey-internal}{mdmarea}
\aliasA{mdmlin}{spsurvey-internal}{mdmlin}
\aliasA{mdmpts}{spsurvey-internal}{mdmpts}
\aliasA{numLevels}{spsurvey-internal}{numLevels}
\aliasA{pickGridCells}{spsurvey-internal}{pickGridCells}
\aliasA{pointInPolygonFile}{spsurvey-internal}{pointInPolygonFile}
\aliasA{pointInPolygonObj}{spsurvey-internal}{pointInPolygonObj}
\aliasA{ranho}{spsurvey-internal}{ranho}
\aliasA{readDbfFile}{spsurvey-internal}{readDbfFile}
\aliasA{readShapeFile}{spsurvey-internal}{readShapeFile}
\aliasA{readShapeFilePts}{spsurvey-internal}{readShapeFilePts}
\aliasA{relrisk.var}{spsurvey-internal}{relrisk.var}
\aliasA{selectframe}{spsurvey-internal}{selectframe}
\aliasA{selectpts}{spsurvey-internal}{selectpts}
\aliasA{shape2spList}{spsurvey-internal}{shape2spList}
\aliasA{simex}{spsurvey-internal}{simex}
\aliasA{sorted}{spsurvey-internal}{sorted}
\aliasA{total.var}{spsurvey-internal}{total.var}
\aliasA{uniqueID}{spsurvey-internal}{uniqueID}
\aliasA{vecprint}{spsurvey-internal}{vecprint}
\methaliasA{vecprint}{spsurvey-internal}{vecprint}
\aliasA{warnprnt}{spsurvey-internal}{warnprnt}
\aliasA{wnas}{spsurvey-internal}{wnas}
\aliasA{writeShapeFilePoint}{spsurvey-internal}{writeShapeFilePoint}
\aliasA{writeShapeFilePolygon}{spsurvey-internal}{writeShapeFilePolygon}
\keyword{internal}{spsurvey-internal}
\begin{Description}\relax
These functions are internal spsurvey functions.
\end{Description}
\begin{Usage}
\begin{verbatim}
mdmpts(mdcaty, n.desired)
mdmlin(len, mdcaty, n.desired)
mdmarea(area, mdcaty, n.desired)
cell.wt(cel, xc, yc, dx, dy, pts)
selectpts(rdx, xc, yc, dx, dy, pts)
selectframe(rord, xc, yc, dx, dy, pts)
ftnt.inv.fcn(y, a=1)
vecprint(x, n.char=78)
shape2spList(shape, shp.type, ID)
ranho(adr, size)
readDbfFile(fileNamePrefix)
readShapeFile(fileNamePrefix)
readShapeFilePts(fileNamePrefix)
getRecordShapeSizes(fileNamePrefix)
writeShapeFilePoint(xVec, yVec, prjFileNameVec, dbfFieldNames, dbfFields,
   filePrefix)
writeShapeFilePolygon(shapeTypeVal, fileLengthVal, contentLenVec, nPartsVec,
   nPointsVec, partsVec, xVec, yVec, prjFileNameVec, dbfFieldNames, dbfFields,
   filePrefix)
pointInPolygonObj(ptXVec, ptYVec, polyXVec, polyYVec)
numLevels(fileNamePrefix, nsmpVec, shiftGridVec,
   startLevVec, maxLevVec, dsgnmdIDVec, dsgnmdVec)
constructAddr(xcVec, ycVec, dxVec, dyVec, nlevVec)
pickGridCells(samplesize, idxVec)
pointInPolygonFile(fileNamePrefix, xcsVec, ycsVec, dsgnmdIDVec, dsgnmdVec)
linSample(fileNamePrefix, xcVec, ycVec, dxVec, dyVec, dsgnmdIDVec, dsgnmdVec)
getRecordIDs(areaCumSumVec, sampPosVec, dsgnIDVec)
getShapeBox(fileNamePrefix, dsgnIDVec)
linSampleIRS(fileNamePrefix, lenCumSumVec, sampPosVec, dsgnIDVec, dsgnLenVec,
   dsgnMdmVec)

dframe.check(sites, design, subpop, data.cat, data.cont,
   design.names)
input.check(nresp, wgt, sigma, var.sigma, xcoord, ycoord,
  stratum.ind, stratum, stratum.levels, nstrata, cluster.ind,
  cluster, cluster.levels, ncluster, N.cluster, wgt1, xcoord1,
  ycoord1, popsize, stage1size, pcfactor.ind, support,
  swgt.ind, swgt, swgt1, unitsize, vartype, conf, cdfval=NULL,
  pctval=NULL, subpop=NULL)
vecprint(x, n.char=78)
uniqueID(siteID)
catvar.prop(z, wgt, x, y, prop, stratum.ind, stratum.level,
  cluster.ind, cluster, N.cluster, wgt1, x1, y1, popsize,
  pcfactor.ind, stage1size, support, vartype, warn.ind,
  warn.df, warn.vec)
catvar.size(z, wgt, x, y, size, stratum.ind, stratum.level,
  cluster.ind, cluster, N.cluster, wgt1, x1, y1, popsize,
  pcfactor.ind, stage1size, support, vartype, warn.ind,
  warn.df, warn.vec)
cdf.nresp(z, val)
cdf.prop(z, wgt, val, cluster.ind, cluster, wgt1)
cdf.total(z, wgt, val, cluster.ind, cluster, wgt1, popsize)
cdf.size.prop(z, wgt, swgt, val, cluster.ind, cluster,
  wgt1, swgt1)
cdf.size.total(z, wgt, swgt, val, cluster.ind, cluster, 
  wgt1, swgt1, unitsize)
cdfvar.prop(z, wgt, x, y, val, cdfest, stratum.ind,
  stratum.level, cluster.ind, cluster, N.cluster, wgt1, x1,
  y1, popsize, pcfactor.ind, stage1size, support, vartype,
  warn.ind, warn.df, warn.vec)
cdfvar.total(z, wgt, x, y, val, cdfest, stratum.ind,
  stratum.level, cluster.ind, cluster, N.cluster, wgt1, x1,
  y1, popsize, pcfactor.ind, stage1size, support, vartype,
  warn.ind, warn.df, warn.vec)
cdfvar.size.prop(z, wgt, x, y, val, cdfest, stratum.ind,
  stratum.level, cluster.ind, cluster, N.cluster, wgt1, x1,
  y1, popsize, pcfactor.ind, stage1size, support, swgt, swgt1,
  vartype, warn.ind, warn.df, warn.vec)
cdfvar.size.total(z, wgt, x, y, val, cdfest, stratum.ind,
  stratum.level, cluster.ind, cluster, N.cluster, wgt1, x1,
  y1, popsize, pcfactor.ind, stage1size, support, swgt, swgt1,
  unitsize, vartype, warn.ind, warn.df, warn.vec)
cdfvar.test (sampl, bounds, vartype)
simex(z, val, sigma, var.sigma, cluster.ind, cluster)
dcdf.prop(g, wgt, cluster.ind, cluster, wgt1)
dcdf.total(g, wgt, cluster.ind, cluster, wgt1, popsize)
dcdf.size.prop(g, wgt, swgt, cluster.ind, cluster, wgt1,
  swgt1)
dcdf.size.total(g, wgt, swgt, cluster.ind, cluster, wgt1,
  swgt1, unitsize)
dcdfvar.prop(g, dg, var.sigma, wgt, x, y, cdfest,
   stratum.ind, stratum.level, cluster.ind, cluster,
   N.cluster, wgt1, x1, y1, popsize, pcfactor.ind, stage1size,
   support, vartype, warn.ind, warn.df, warn.vec)
dcdfvar.total(g, dg, var.sigma, wgt, x, y, cdfest,
   stratum.ind, stratum.level, cluster.ind, cluster,
   N.cluster, wgt1, x1, y1, popsize, pcfactor.ind, stage1size,
   support, vartype, warn.ind, warn.df, warn.vec)
dcdfvar.size.prop(g, dg, var.sigma, wgt, x, y, cdfest,
   stratum.ind, stratum.level, cluster.ind, cluster,
   N.cluster, wgt1, x1, y1, popsize, pcfactor.ind, stage1size,
   support, swgt, swgt1, vartype, warn.ind, warn.df, warn.vec)
dcdfvar.size.total(g, dg, var.sigma, wgt, x, y, cdfest,
   stratum.ind, stratum.level, cluster.ind, cluster,
   N.cluster, wgt1, x1, y1, popsize, pcfactor.ind, stage1size,
   support, swgt, swgt1, unitsize, vartype, warn.ind, warn.df,
   warn.vec)
isotonic(y, minval, maxval)
sorted(x)
total.var (z, wgt, x, y, mean.est, var.est, sd.est,
  stratum.ind, stratum.level, cluster.ind, cluster, N.cluster,
  wgt1, x1, y1, popsize, pcfactor.ind, stage1size, support,
  vartype, warn.ind, warn.df, warn.vec)
relrisk.var(response, stressor, response.levels,
   stressor.levels, wgt, x, y, stratum.ind, stratum.level,
   cluster.ind, cluster, N.cluster, wgt1, x1, y1, popsize,
   pcfactor.ind, stage1size, support, vartype, warn.ind,
   warn.df, warn.vec)
localmean.weight(x, y, prb, nbh)
localmean.var(z, weight.lst)
localmean.cov(zmat, weight.lst)
localmean.df(weight.lst)
wnas(data)
input.format(x, n.digits, miss="NA")
warnprnt(warn.df, m=1:nrow(warn.df))
\end{verbatim}
\end{Usage}
\begin{Details}\relax
These functions are not to be called by the user.
\end{Details}

\HeaderA{total.est}{Population Total, Mean, Variance, and Standard Deviation}{total.est}
\keyword{survey}{total.est}
\keyword{univar}{total.est}
\begin{Description}\relax
This function calculates estimates of the population total, mean, variance, and
standard deviation of a response variable, where the response variable may be
defined for either a finite or an extensive resource.  In addition the 
standard error of the population estimates and confidence bounds are
calculated.
\end{Description}
\begin{Usage}
\begin{verbatim}
total.est(z, wgt, x=NULL, y=NULL, stratum=NULL, cluster=NULL, N.cluster=NULL,
   wgt1=NULL, x1=NULL, y1=NULL, popsize=NULL, stage1size=NULL, support=NULL,
   swgt=NULL, swgt1=NULL, unitsize=NULL, vartype="Local", conf=95,
   check.ind=TRUE, warn.ind=NULL, warn.df=NULL, warn.vec=NULL)
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{z}] the response value for each site.
\item[\code{wgt}] the final adjusted weight (inverse of the sample inclusion
probability) for each site, which is either the weight for a 
single-stage sample or the stage two weight for a two-stage sample.
\item[\code{x}] x-coordinate for location for each site, which is either the
x-coordinate for a single-stage sample or the stage two 
x-coordinate for a two-stage sample.  The default is NULL.
\item[\code{y}] y-coordinate for location for each site, which is either the
y-coordinate for a single-stage sample or the stage two 
y-coordinate for a two-stage sample.  The default is NULL.
\item[\code{stratum}] the stratum for each site.  The default is NULL.
\item[\code{cluster}] the stage one sampling unit (primary sampling unit or cluster) 
code for each site.  The default is NULL.
\item[\code{N.cluster}] the number of stage one sampling units in the resource, which 
is required for calculation of finite and continuous population 
correction factors for a two-stage sample.  For a stratified sample 
this variable must be a vector containing a value for each stratum and
must have the names attribute set to identify the stratum codes.  The
default is NULL.
\item[\code{wgt1}] the final adjusted stage one weight for each site.  The default
is NULL.
\item[\code{x1}] the stage one x-coordinate for location for each site.  The default
is NULL.
\item[\code{y1}] the stage one y-coordinate for location for each site.  The default
is NULL.
\item[\code{popsize}] the known size of the resource - the total number of sampling 
units of a finite resource or the measure of an extensive resource,
which is required for calculation of finite and continuous population 
correction factors for a single-stage sample.  This variable is also 
used to adjust estimators for the known size of a resource.  For a
stratified sample this variable must be a vector containing a value 
for each stratum and must have the names attribute set to identify the
stratum codes.  The default is NULL.
\item[\code{stage1size}] the known size of the stage one sampling units of a two-
stage sample, which is required for calculation of finite and  
continuous population correction factors for a two-stage sample and 
must have the names attribute set to identify the stage one sampling 
unit codes.  For a stratified sample, the names attribute must be set
to identify both stratum codes and stage one sampling unit codes using
a convention where the two codes are separated by the \# symbol, e.g.,
"Stratum 1\#Cluster 1".  The default is NULL.
\item[\code{support}] the support value for each site - the value one (1) for a 
site from a finite resource or the measure of the sampling unit  
associated with a site from an extensive resource, which is required  
for calculation of finite and continuous population correction  
factors.  The default is NULL.
\item[\code{swgt}] the size-weight for each site, which is the stage two size-weight 
for a two-stage sample.  The default is NULL.
\item[\code{swgt1}] the stage one size-weight for each site.  The default is NULL.
\item[\code{unitsize}] the known sum of the size-weights of the resource, which for a 
stratified sample must be a vector containing a value for each stratum 
and must have the names attribute set to identify the stratum codes.  
The default is NULL.
\item[\code{vartype}] the choice of variance estimator, where "Local" = local mean
estimator and "SRS" = SRS estimator.  The default is "Local".
\item[\code{conf}] the confidence level.  The default is 95\%.
\item[\code{check.ind}] a logical value that indicates whether compatability
checking of the input values is conducted, where TRUE = conduct 
compatibility checking and FALSE = do not conduct compatibility 
checking.  The default is TRUE.
\item[\code{warn.ind}] a logical value that indicates whether warning messages were
generated, where TRUE = warning messages were generated and FALSE = warning
messages were not generated.  The default is NULL.
\item[\code{warn.df}] a data frame for storing warning messages.  The default is
NULL.
\item[\code{warn.vec}] a vector that contains names of the population type, the
subpopulation, and an indicator.  The default is NULL.
\end{ldescription}
\end{Arguments}
\begin{Details}\relax
The Horvitz-Thompson estimator is used to calculate the total, variance, and 
standard deviation estimates.  The Horvitz-Thompson ratio estimator, i.e., the 
ratio of two Horvitz-Thompson estimators, is used to calculate the mean 
estimate.  Variance estimates are calculated using either the local mean 
variance estimator or the simple random sampling (SRS) variance 
estimator.  The choice of variance estimator is subject to user control.  The 
local mean variance estimator requires the x-coordinate and the 
y-coordinate of each site.  The SRS variance estimator uses the 
independent random sample approximation to calculate joint inclusion 
probabilities.  Confidence bounds are calculated using a Normal 
distribution multiplier.  The function can accommodate a stratified sample.  
For a stratified sample, separate estimates and standard errors are calculated 
for each stratum, which are used to produce estimates and standard errors for 
all strata combined.  Strata that contain a single value are removed.  For a 
stratified sample, when either the size of the resource or the sum of the size-
weights of the resource is provided for each stratum, those values are used as 
stratum weights for calculating the estimates and standard errors for all 
strata combined.  For a stratified sample when neither the size of the resource
nor the sum of the size-weights of the resource is provided for each stratum, 
estimated values are used as stratum weights for calculating the estimates and 
standard errors for all strata combined.  The function can accommodate 
single-stage and two-stage samples for both stratified and unstratified 
sampling designs.  Finite population and continuous population correction 
factors can be utilized in variance estimation.  The function checks for 
compatibility of input values and removes missing values.
\end{Details}
\begin{Section}{Value}
If the function was called by the cont.analysis function, then value is a list
containing the following components:
\Itemize{
\item \code{Results} - a data frame containing estimates and confidence
bounds
\item \code{warn.ind} - a logical value indicating whether warning messages
were generated
\item \code{warn.df} - a data frame containing warning messages
}
If the function was called directly, then value is a data frame containing
estimates and confidence bounds.
\end{Section}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{References}\relax
Diaz-Ramos, S., D.L. Stevens, Jr., and A.R. Olsen. (1996).  \emph{EMAP
Statistical Methods Manual.} EPA/620/R-96/XXX.  Corvallis, OR: U.S.
Environmental Protection Agency, Office of Research and Development, National
Health Effects and Environmental Research Laboratory, Western Ecology
Division.
\end{References}
\begin{Examples}
\begin{ExampleCode}
z <- rnorm(100, 10, 1)
wgt <- runif(100, 10, 100)
total.est(z, wgt, vartype="SRS")

x <- runif(100)
y <- runif(100)
total.est(z, wgt, x, y)
\end{ExampleCode}
\end{Examples}

\HeaderA{write.object}{Write an Object to a Plot}{write.object}
\keyword{aplot}{write.object}
\begin{Description}\relax
This function writes the contents of an object, which may be either a data frame
or a matrix, to a plot.
\end{Description}
\begin{Usage}
\begin{verbatim}
write.object(obj, n.digits=2, r.names=TRUE, c.names=TRUE, r.cex=1, c.cex=1,
   miss="NA")
\end{verbatim}
\end{Usage}
\begin{Arguments}
\begin{ldescription}
\item[\code{obj}] the object (either a data frame or a matrix).
\item[\code{n.digits}] the number of digits after the decimal point for numeric
values.  The default is 2.
\item[\code{r.names}] a logical value that indicates whether to print the row names,
where TRUE = print the row names and  FALSE = do not print the row names.
The default is TRUE.
\item[\code{c.names}] a logical value that indicates whether to print the column
names, where TRUE = print the column names and  FALSE = do not print the
column names.  The default is TRUE.
\item[\code{r.cex}] character expansion parameter for the row labels.  The default is
1.
\item[\code{c.cex}] character expansion parameter for the column labels.  The default
is 1.
\item[\code{miss}] the missing value code expressed as a character string.  The
default is "NA".
\end{ldescription}
\end{Arguments}
\begin{Value}
NULL
\end{Value}
\begin{Author}\relax
Tom Kincaid \email{Kincaid.Tom@epa.gov}
\end{Author}
\begin{Examples}
\begin{ExampleCode}
z <- rnorm(100)
z.mean <- c(tapply(z, rep(1:4, rep(25,4)), mean), mean(z))
z.sd <- sqrt(c(tapply(z, rep(1:4, rep(25,4)), var), var(z)))
z.upper <- z.mean+1.96*z.sd
z.lower <- z.mean-1.96*z.sd
obj <- data.frame(rbind(z.mean, z.sd, z.upper, z.lower))
dimnames(obj) <- list(c("Mean Estimate", "Standard Deviation",
  "Lower 95% Conf. Bound", "Upper 95% Conf. Bound"), c(
  paste("Stratum", 1:4, sep=""), "AllStrata"))
write.object(obj, n.digits=3, r.cex=0.75)

obj <- data.frame(matrix(round(5 + runif(30), 1), nrow=6))
colnames(obj) <- c("United.States", "Russia", "Germany",
  "Japan", "France")
write.object(obj, n.digits=1, r.names=FALSE)
\end{ExampleCode}
\end{Examples}

\end{document}
